library(ggplot2)        
library(matrixcalc)       
        
        
df2 <- read.LIS('it86h')              
        
        
Y <- df2$hilabour           
print(summary(Y, digits=10))             
       
              
df2 <- df2[Y>0 & !is.na(Y),]         
        
weights <- df2$hwgt        
print(summary(weights))         
print(length(weights))        
Y <- Y[Y>0 & !is.na(Y)]       
                    
      
#**************************MWL********************************      
   
#the data      
newweight <- weights     
X <- Y/1000     
   
   
   
#for the daic function: 
 
#the first derivative   
partial1 <- function(x,theta,gamma,p,beta){   
  dtheta <- (p * (0.5 * (((theta + 3 * gamma) + theta)/(2 * pi * gamma *    
    (x^3)) * ((theta * (theta + 3 * gamma))/(2 * pi * gamma *    
    (x^3)))^-0.5)) * exp((-(x - sqrt(theta * (theta + 3 * gamma)))^2)/(2 *    
    gamma * x)) + p * sqrt((theta * (theta + 3 * gamma))/(2 *    
    pi * gamma * (x^3))) * (exp((-(x - sqrt(theta * (theta +    
    3 * gamma)))^2)/(2 * gamma * x)) * (2 * (0.5 * (((theta +    
    3 * gamma) + theta) * (theta * (theta + 3 * gamma))^-0.5) *    
    (x - sqrt(theta * (theta + 3 * gamma))))/(2 * gamma * x))) +    
    (+(1 - p) * (0.5 * (((theta + 3 * gamma * beta) + theta)/(2 *    
        pi * gamma * beta * (x^3)) * ((theta * (theta + 3 * gamma *    
        beta))/(2 * pi * gamma * beta * (x^3)))^-0.5)) * exp((-(x -    
        sqrt(theta * (theta + 3 * gamma * beta)))^2)/(2 * gamma *    
        beta * x)) + +(1 - p) * sqrt((theta * (theta + 3 * gamma *    
        beta))/(2 * pi * gamma * beta * (x^3))) * (exp((-(x -    
        sqrt(theta * (theta + 3 * gamma * beta)))^2)/(2 * gamma *    
        beta * x)) * (2 * (0.5 * (((theta + 3 * gamma * beta) +    
        theta) * (theta * (theta + 3 * gamma * beta))^-0.5) *    
        (x - sqrt(theta * (theta + 3 * gamma * beta))))/(2 *    
        gamma * beta * x)))))/(p * sqrt((theta * (theta + 3 *    
    gamma))/(2 * pi * gamma * (x^3))) * exp((-(x - sqrt(theta *    
    (theta + 3 * gamma)))^2)/(2 * gamma * x)) + +(1 - p) * sqrt((theta *    
    (theta + 3 * gamma * beta))/(2 * pi * gamma * beta * (x^3))) *    
    exp((-(x - sqrt(theta * (theta + 3 * gamma * beta)))^2)/(2 *    
        gamma * beta * x)))   
     
  dgamma <- (p * (0.5 * ((theta * 3/(2 * pi * gamma * (x^3)) - (theta * (theta +    
    3 * gamma)) * (2 * pi * (x^3))/(2 * pi * gamma * (x^3))^2) *    
    ((theta * (theta + 3 * gamma))/(2 * pi * gamma * (x^3)))^-0.5)) *    
    exp((-(x - sqrt(theta * (theta + 3 * gamma)))^2)/(2 * gamma *    
        x)) + p * sqrt((theta * (theta + 3 * gamma))/(2 * pi *    
    gamma * (x^3))) * (exp((-(x - sqrt(theta * (theta + 3 * gamma)))^2)/(2 *    
    gamma * x)) * (2 * (0.5 * (theta * 3 * (theta * (theta +    
    3 * gamma))^-0.5) * (x - sqrt(theta * (theta + 3 * gamma))))/(2 *    
    gamma * x) - (-(x - sqrt(theta * (theta + 3 * gamma)))^2) *    
    (2 * x)/(2 * gamma * x)^2)) + (+(1 - p) * (0.5 * ((theta *    
    (3 * beta)/(2 * pi * gamma * beta * (x^3)) - (theta * (theta +    
    3 * gamma * beta)) * (2 * pi * beta * (x^3))/(2 * pi * gamma *    
    beta * (x^3))^2) * ((theta * (theta + 3 * gamma * beta))/(2 *    
    pi * gamma * beta * (x^3)))^-0.5)) * exp((-(x - sqrt(theta *    
    (theta + 3 * gamma * beta)))^2)/(2 * gamma * beta * x)) +    
    +(1 - p) * sqrt((theta * (theta + 3 * gamma * beta))/(2 *    
        pi * gamma * beta * (x^3))) * (exp((-(x - sqrt(theta *    
        (theta + 3 * gamma * beta)))^2)/(2 * gamma * beta * x)) *    
        (2 * (0.5 * (theta * (3 * beta) * (theta * (theta + 3 *    
            gamma * beta))^-0.5) * (x - sqrt(theta * (theta +    
            3 * gamma * beta))))/(2 * gamma * beta * x) - (-(x -    
            sqrt(theta * (theta + 3 * gamma * beta)))^2) * (2 *    
            beta * x)/(2 * gamma * beta * x)^2))))/(p * sqrt((theta *    
    (theta + 3 * gamma))/(2 * pi * gamma * (x^3))) * exp((-(x -    
    sqrt(theta * (theta + 3 * gamma)))^2)/(2 * gamma * x)) +    
    +(1 - p) * sqrt((theta * (theta + 3 * gamma * beta))/(2 *    
        pi * gamma * beta * (x^3))) * exp((-(x - sqrt(theta *    
        (theta + 3 * gamma * beta)))^2)/(2 * gamma * beta * x)))   
     
  dp <- (sqrt((theta * (theta + 3 * gamma))/(2 * pi * gamma * (x^3))) *    
    exp((-(x - sqrt(theta * (theta + 3 * gamma)))^2)/(2 * gamma *    
        x)) - sqrt((theta * (theta + 3 * gamma * beta))/(2 *    
    pi * gamma * beta * (x^3))) * exp((-(x - sqrt(theta * (theta +    
    3 * gamma * beta)))^2)/(2 * gamma * beta * x)))/(p * sqrt((theta *    
    (theta + 3 * gamma))/(2 * pi * gamma * (x^3))) * exp((-(x -    
    sqrt(theta * (theta + 3 * gamma)))^2)/(2 * gamma * x)) +    
    +(1 - p) * sqrt((theta * (theta + 3 * gamma * beta))/(2 *    
        pi * gamma * beta * (x^3))) * exp((-(x - sqrt(theta *    
        (theta + 3 * gamma * beta)))^2)/(2 * gamma * beta * x)))   
     
  dbeta <- (+(1 - p) * (0.5 * ((theta * (3 * gamma)/(2 * pi * gamma * beta *    
    (x^3)) - (theta * (theta + 3 * gamma * beta)) * (2 * pi *    
    gamma * (x^3))/(2 * pi * gamma * beta * (x^3))^2) * ((theta *    
    (theta + 3 * gamma * beta))/(2 * pi * gamma * beta * (x^3)))^-0.5)) *    
    exp((-(x - sqrt(theta * (theta + 3 * gamma * beta)))^2)/(2 *    
        gamma * beta * x)) + +(1 - p) * sqrt((theta * (theta +    
    3 * gamma * beta))/(2 * pi * gamma * beta * (x^3))) * (exp((-(x -    
    sqrt(theta * (theta + 3 * gamma * beta)))^2)/(2 * gamma *    
    beta * x)) * (2 * (0.5 * (theta * (3 * gamma) * (theta *    
    (theta + 3 * gamma * beta))^-0.5) * (x - sqrt(theta * (theta +    
    3 * gamma * beta))))/(2 * gamma * beta * x) - (-(x - sqrt(theta *    
    (theta + 3 * gamma * beta)))^2) * (2 * gamma * x)/(2 * gamma *    
    beta * x)^2)))/(p * sqrt((theta * (theta + 3 * gamma))/(2 *    
    pi * gamma * (x^3))) * exp((-(x - sqrt(theta * (theta + 3 *    
    gamma)))^2)/(2 * gamma * x)) + +(1 - p) * sqrt((theta * (theta +    
    3 * gamma * beta))/(2 * pi * gamma * beta * (x^3))) * exp((-(x -    
    sqrt(theta * (theta + 3 * gamma * beta)))^2)/(2 * gamma *    
    beta * x)))   
     
  d1 <- cbind(dtheta,dgamma,dp,dbeta)   
    return(d1)   
}   
   
   
   
   
#the second derivative 
   
partial2 <- function(x,theta,gamma,p,beta){   
     
  dthetatheta <- (p * (0.5 * ((1 + 1)/(2 * pi * gamma * (x^3)) * ((theta * (theta +    
    3 * gamma))/(2 * pi * gamma * (x^3)))^-0.5 + ((theta + 3 *    
    gamma) + theta)/(2 * pi * gamma * (x^3)) * (-0.5 * (((theta +    
    3 * gamma) + theta)/(2 * pi * gamma * (x^3)) * ((theta *    
    (theta + 3 * gamma))/(2 * pi * gamma * (x^3)))^-1.5)))) *    
    exp((-(x - sqrt(theta * (theta + 3 * gamma)))^2)/(2 * gamma *    
        x)) + p * (0.5 * (((theta + 3 * gamma) + theta)/(2 *    
    pi * gamma * (x^3)) * ((theta * (theta + 3 * gamma))/(2 *    
    pi * gamma * (x^3)))^-0.5)) * (exp((-(x - sqrt(theta * (theta +    
    3 * gamma)))^2)/(2 * gamma * x)) * (2 * (0.5 * (((theta +    
    3 * gamma) + theta) * (theta * (theta + 3 * gamma))^-0.5) *    
    (x - sqrt(theta * (theta + 3 * gamma))))/(2 * gamma * x))) +    
    (p * (0.5 * (((theta + 3 * gamma) + theta)/(2 * pi * gamma *    
        (x^3)) * ((theta * (theta + 3 * gamma))/(2 * pi * gamma *    
        (x^3)))^-0.5)) * (exp((-(x - sqrt(theta * (theta + 3 *    
        gamma)))^2)/(2 * gamma * x)) * (2 * (0.5 * (((theta +    
        3 * gamma) + theta) * (theta * (theta + 3 * gamma))^-0.5) *    
        (x - sqrt(theta * (theta + 3 * gamma))))/(2 * gamma *    
        x))) + p * sqrt((theta * (theta + 3 * gamma))/(2 * pi *    
        gamma * (x^3))) * (exp((-(x - sqrt(theta * (theta + 3 *    
        gamma)))^2)/(2 * gamma * x)) * (2 * (0.5 * (((theta +    
        3 * gamma) + theta) * (theta * (theta + 3 * gamma))^-0.5) *    
        (x - sqrt(theta * (theta + 3 * gamma))))/(2 * gamma *    
        x)) * (2 * (0.5 * (((theta + 3 * gamma) + theta) * (theta *    
        (theta + 3 * gamma))^-0.5) * (x - sqrt(theta * (theta +    
        3 * gamma))))/(2 * gamma * x)) + exp((-(x - sqrt(theta *    
        (theta + 3 * gamma)))^2)/(2 * gamma * x)) * (2 * (0.5 *    
        ((1 + 1) * (theta * (theta + 3 * gamma))^-0.5 + ((theta +    
            3 * gamma) + theta) * (-0.5 * (((theta + 3 * gamma) +    
            theta) * (theta * (theta + 3 * gamma))^-1.5))) *    
        (x - sqrt(theta * (theta + 3 * gamma))) - 0.5 * (((theta +    
        3 * gamma) + theta) * (theta * (theta + 3 * gamma))^-0.5) *    
        (0.5 * (((theta + 3 * gamma) + theta) * (theta * (theta +    
            3 * gamma))^-0.5)))/(2 * gamma * x)))) + (+(1 - p) *    
    (0.5 * ((1 + 1)/(2 * pi * gamma * beta * (x^3)) * ((theta *    
        (theta + 3 * gamma * beta))/(2 * pi * gamma * beta *    
        (x^3)))^-0.5 + ((theta + 3 * gamma * beta) + theta)/(2 *    
        pi * gamma * beta * (x^3)) * (-0.5 * (((theta + 3 * gamma *    
        beta) + theta)/(2 * pi * gamma * beta * (x^3)) * ((theta *    
        (theta + 3 * gamma * beta))/(2 * pi * gamma * beta *    
        (x^3)))^-1.5)))) * exp((-(x - sqrt(theta * (theta + 3 *    
    gamma * beta)))^2)/(2 * gamma * beta * x)) + +(1 - p) * (0.5 *    
    (((theta + 3 * gamma * beta) + theta)/(2 * pi * gamma * beta *    
        (x^3)) * ((theta * (theta + 3 * gamma * beta))/(2 * pi *    
        gamma * beta * (x^3)))^-0.5)) * (exp((-(x - sqrt(theta *    
    (theta + 3 * gamma * beta)))^2)/(2 * gamma * beta * x)) *    
    (2 * (0.5 * (((theta + 3 * gamma * beta) + theta) * (theta *    
        (theta + 3 * gamma * beta))^-0.5) * (x - sqrt(theta *    
        (theta + 3 * gamma * beta))))/(2 * gamma * beta * x))) +    
    (+(1 - p) * (0.5 * (((theta + 3 * gamma * beta) + theta)/(2 *    
        pi * gamma * beta * (x^3)) * ((theta * (theta + 3 * gamma *    
        beta))/(2 * pi * gamma * beta * (x^3)))^-0.5)) * (exp((-(x -    
        sqrt(theta * (theta + 3 * gamma * beta)))^2)/(2 * gamma *    
        beta * x)) * (2 * (0.5 * (((theta + 3 * gamma * beta) +    
        theta) * (theta * (theta + 3 * gamma * beta))^-0.5) *    
        (x - sqrt(theta * (theta + 3 * gamma * beta))))/(2 *    
        gamma * beta * x))) + +(1 - p) * sqrt((theta * (theta +    
        3 * gamma * beta))/(2 * pi * gamma * beta * (x^3))) *    
        (exp((-(x - sqrt(theta * (theta + 3 * gamma * beta)))^2)/(2 *    
            gamma * beta * x)) * (2 * (0.5 * (((theta + 3 * gamma *    
            beta) + theta) * (theta * (theta + 3 * gamma * beta))^-0.5) *    
            (x - sqrt(theta * (theta + 3 * gamma * beta))))/(2 *    
            gamma * beta * x)) * (2 * (0.5 * (((theta + 3 * gamma *    
            beta) + theta) * (theta * (theta + 3 * gamma * beta))^-0.5) *    
            (x - sqrt(theta * (theta + 3 * gamma * beta))))/(2 *    
            gamma * beta * x)) + exp((-(x - sqrt(theta * (theta +    
            3 * gamma * beta)))^2)/(2 * gamma * beta * x)) *    
            (2 * (0.5 * ((1 + 1) * (theta * (theta + 3 * gamma *    
                beta))^-0.5 + ((theta + 3 * gamma * beta) + theta) *    
                (-0.5 * (((theta + 3 * gamma * beta) + theta) *    
                  (theta * (theta + 3 * gamma * beta))^-1.5))) *    
                (x - sqrt(theta * (theta + 3 * gamma * beta))) -    
                0.5 * (((theta + 3 * gamma * beta) + theta) *    
                  (theta * (theta + 3 * gamma * beta))^-0.5) *    
                  (0.5 * (((theta + 3 * gamma * beta) + theta) *    
                    (theta * (theta + 3 * gamma * beta))^-0.5)))/(2 *    
                gamma * beta * x))))))/(p * sqrt((theta * (theta +    
    3 * gamma))/(2 * pi * gamma * (x^3))) * exp((-(x - sqrt(theta *    
    (theta + 3 * gamma)))^2)/(2 * gamma * x)) + +(1 - p) * sqrt((theta *    
    (theta + 3 * gamma * beta))/(2 * pi * gamma * beta * (x^3))) *    
    exp((-(x - sqrt(theta * (theta + 3 * gamma * beta)))^2)/(2 *    
        gamma * beta * x))) - (p * (0.5 * (((theta + 3 * gamma) +    
    theta)/(2 * pi * gamma * (x^3)) * ((theta * (theta + 3 *    
    gamma))/(2 * pi * gamma * (x^3)))^-0.5)) * exp((-(x - sqrt(theta *    
    (theta + 3 * gamma)))^2)/(2 * gamma * x)) + p * sqrt((theta *    
    (theta + 3 * gamma))/(2 * pi * gamma * (x^3))) * (exp((-(x -    
    sqrt(theta * (theta + 3 * gamma)))^2)/(2 * gamma * x)) *    
    (2 * (0.5 * (((theta + 3 * gamma) + theta) * (theta * (theta +    
        3 * gamma))^-0.5) * (x - sqrt(theta * (theta + 3 * gamma))))/(2 *    
        gamma * x))) + (+(1 - p) * (0.5 * (((theta + 3 * gamma *    
    beta) + theta)/(2 * pi * gamma * beta * (x^3)) * ((theta *    
    (theta + 3 * gamma * beta))/(2 * pi * gamma * beta * (x^3)))^-0.5)) *    
    exp((-(x - sqrt(theta * (theta + 3 * gamma * beta)))^2)/(2 *    
        gamma * beta * x)) + +(1 - p) * sqrt((theta * (theta +    
    3 * gamma * beta))/(2 * pi * gamma * beta * (x^3))) * (exp((-(x -    
    sqrt(theta * (theta + 3 * gamma * beta)))^2)/(2 * gamma *    
    beta * x)) * (2 * (0.5 * (((theta + 3 * gamma * beta) + theta) *    
    (theta * (theta + 3 * gamma * beta))^-0.5) * (x - sqrt(theta *    
    (theta + 3 * gamma * beta))))/(2 * gamma * beta * x))))) *    
    (p * (0.5 * (((theta + 3 * gamma) + theta)/(2 * pi * gamma *    
        (x^3)) * ((theta * (theta + 3 * gamma))/(2 * pi * gamma *    
        (x^3)))^-0.5)) * exp((-(x - sqrt(theta * (theta + 3 *    
        gamma)))^2)/(2 * gamma * x)) + p * sqrt((theta * (theta +    
        3 * gamma))/(2 * pi * gamma * (x^3))) * (exp((-(x - sqrt(theta *    
        (theta + 3 * gamma)))^2)/(2 * gamma * x)) * (2 * (0.5 *    
        (((theta + 3 * gamma) + theta) * (theta * (theta + 3 *    
            gamma))^-0.5) * (x - sqrt(theta * (theta + 3 * gamma))))/(2 *    
        gamma * x))) + (+(1 - p) * (0.5 * (((theta + 3 * gamma *    
        beta) + theta)/(2 * pi * gamma * beta * (x^3)) * ((theta *    
        (theta + 3 * gamma * beta))/(2 * pi * gamma * beta *    
        (x^3)))^-0.5)) * exp((-(x - sqrt(theta * (theta + 3 *    
        gamma * beta)))^2)/(2 * gamma * beta * x)) + +(1 - p) *    
        sqrt((theta * (theta + 3 * gamma * beta))/(2 * pi * gamma *    
            beta * (x^3))) * (exp((-(x - sqrt(theta * (theta +    
        3 * gamma * beta)))^2)/(2 * gamma * beta * x)) * (2 *    
        (0.5 * (((theta + 3 * gamma * beta) + theta) * (theta *    
            (theta + 3 * gamma * beta))^-0.5) * (x - sqrt(theta *    
            (theta + 3 * gamma * beta))))/(2 * gamma * beta *    
        x)))))/(p * sqrt((theta * (theta + 3 * gamma))/(2 * pi *    
    gamma * (x^3))) * exp((-(x - sqrt(theta * (theta + 3 * gamma)))^2)/(2 *    
    gamma * x)) + +(1 - p) * sqrt((theta * (theta + 3 * gamma *    
    beta))/(2 * pi * gamma * beta * (x^3))) * exp((-(x - sqrt(theta *    
    (theta + 3 * gamma * beta)))^2)/(2 * gamma * beta * x)))^2   
     
     
     
     
  dthetagamma <- (p * (0.5 * ((3/(2 * pi * gamma * (x^3)) - ((theta + 3 * gamma) +    
    theta) * (2 * pi * (x^3))/(2 * pi * gamma * (x^3))^2) * ((theta *    
    (theta + 3 * gamma))/(2 * pi * gamma * (x^3)))^-0.5 + ((theta +    
    3 * gamma) + theta)/(2 * pi * gamma * (x^3)) * (-0.5 * ((theta *    
    3/(2 * pi * gamma * (x^3)) - (theta * (theta + 3 * gamma)) *    
    (2 * pi * (x^3))/(2 * pi * gamma * (x^3))^2) * ((theta *    
    (theta + 3 * gamma))/(2 * pi * gamma * (x^3)))^-1.5)))) *    
    exp((-(x - sqrt(theta * (theta + 3 * gamma)))^2)/(2 * gamma *    
        x)) + p * (0.5 * (((theta + 3 * gamma) + theta)/(2 *    
    pi * gamma * (x^3)) * ((theta * (theta + 3 * gamma))/(2 *    
    pi * gamma * (x^3)))^-0.5)) * (exp((-(x - sqrt(theta * (theta +    
    3 * gamma)))^2)/(2 * gamma * x)) * (2 * (0.5 * (theta * 3 *    
    (theta * (theta + 3 * gamma))^-0.5) * (x - sqrt(theta * (theta +    
    3 * gamma))))/(2 * gamma * x) - (-(x - sqrt(theta * (theta +    
    3 * gamma)))^2) * (2 * x)/(2 * gamma * x)^2)) + (p * (0.5 *    
    ((theta * 3/(2 * pi * gamma * (x^3)) - (theta * (theta +    
        3 * gamma)) * (2 * pi * (x^3))/(2 * pi * gamma * (x^3))^2) *    
        ((theta * (theta + 3 * gamma))/(2 * pi * gamma * (x^3)))^-0.5)) *    
    (exp((-(x - sqrt(theta * (theta + 3 * gamma)))^2)/(2 * gamma *    
        x)) * (2 * (0.5 * (((theta + 3 * gamma) + theta) * (theta *    
        (theta + 3 * gamma))^-0.5) * (x - sqrt(theta * (theta +    
        3 * gamma))))/(2 * gamma * x))) + p * sqrt((theta * (theta +    
    3 * gamma))/(2 * pi * gamma * (x^3))) * (exp((-(x - sqrt(theta *    
    (theta + 3 * gamma)))^2)/(2 * gamma * x)) * (2 * (0.5 * (theta *    
    3 * (theta * (theta + 3 * gamma))^-0.5) * (x - sqrt(theta *    
    (theta + 3 * gamma))))/(2 * gamma * x) - (-(x - sqrt(theta *    
    (theta + 3 * gamma)))^2) * (2 * x)/(2 * gamma * x)^2) * (2 *    
    (0.5 * (((theta + 3 * gamma) + theta) * (theta * (theta +    
        3 * gamma))^-0.5) * (x - sqrt(theta * (theta + 3 * gamma))))/(2 *    
    gamma * x)) + exp((-(x - sqrt(theta * (theta + 3 * gamma)))^2)/(2 *    
    gamma * x)) * (2 * (0.5 * (3 * (theta * (theta + 3 * gamma))^-0.5 +    
    ((theta + 3 * gamma) + theta) * (-0.5 * (theta * 3 * (theta *    
        (theta + 3 * gamma))^-1.5))) * (x - sqrt(theta * (theta +    
    3 * gamma))) - 0.5 * (((theta + 3 * gamma) + theta) * (theta *    
    (theta + 3 * gamma))^-0.5) * (0.5 * (theta * 3 * (theta *    
    (theta + 3 * gamma))^-0.5)))/(2 * gamma * x) - 2 * (0.5 *    
    (((theta + 3 * gamma) + theta) * (theta * (theta + 3 * gamma))^-0.5) *    
    (x - sqrt(theta * (theta + 3 * gamma)))) * (2 * x)/(2 * gamma *    
    x)^2))) + (+(1 - p) * (0.5 * ((3 * beta/(2 * pi * gamma *    
    beta * (x^3)) - ((theta + 3 * gamma * beta) + theta) * (2 *    
    pi * beta * (x^3))/(2 * pi * gamma * beta * (x^3))^2) * ((theta *    
    (theta + 3 * gamma * beta))/(2 * pi * gamma * beta * (x^3)))^-0.5 +    
    ((theta + 3 * gamma * beta) + theta)/(2 * pi * gamma * beta *    
        (x^3)) * (-0.5 * ((theta * (3 * beta)/(2 * pi * gamma *    
        beta * (x^3)) - (theta * (theta + 3 * gamma * beta)) *    
        (2 * pi * beta * (x^3))/(2 * pi * gamma * beta * (x^3))^2) *    
        ((theta * (theta + 3 * gamma * beta))/(2 * pi * gamma *    
            beta * (x^3)))^-1.5)))) * exp((-(x - sqrt(theta *    
    (theta + 3 * gamma * beta)))^2)/(2 * gamma * beta * x)) +    
    +(1 - p) * (0.5 * (((theta + 3 * gamma * beta) + theta)/(2 *    
        pi * gamma * beta * (x^3)) * ((theta * (theta + 3 * gamma *    
        beta))/(2 * pi * gamma * beta * (x^3)))^-0.5)) * (exp((-(x -    
        sqrt(theta * (theta + 3 * gamma * beta)))^2)/(2 * gamma *    
        beta * x)) * (2 * (0.5 * (theta * (3 * beta) * (theta *    
        (theta + 3 * gamma * beta))^-0.5) * (x - sqrt(theta *    
        (theta + 3 * gamma * beta))))/(2 * gamma * beta * x) -    
        (-(x - sqrt(theta * (theta + 3 * gamma * beta)))^2) *    
            (2 * beta * x)/(2 * gamma * beta * x)^2)) + (+(1 -    
    p) * (0.5 * ((theta * (3 * beta)/(2 * pi * gamma * beta *    
    (x^3)) - (theta * (theta + 3 * gamma * beta)) * (2 * pi *    
    beta * (x^3))/(2 * pi * gamma * beta * (x^3))^2) * ((theta *    
    (theta + 3 * gamma * beta))/(2 * pi * gamma * beta * (x^3)))^-0.5)) *    
    (exp((-(x - sqrt(theta * (theta + 3 * gamma * beta)))^2)/(2 *    
        gamma * beta * x)) * (2 * (0.5 * (((theta + 3 * gamma *    
        beta) + theta) * (theta * (theta + 3 * gamma * beta))^-0.5) *    
        (x - sqrt(theta * (theta + 3 * gamma * beta))))/(2 *    
        gamma * beta * x))) + +(1 - p) * sqrt((theta * (theta +    
    3 * gamma * beta))/(2 * pi * gamma * beta * (x^3))) * (exp((-(x -    
    sqrt(theta * (theta + 3 * gamma * beta)))^2)/(2 * gamma *    
    beta * x)) * (2 * (0.5 * (theta * (3 * beta) * (theta * (theta +    
    3 * gamma * beta))^-0.5) * (x - sqrt(theta * (theta + 3 *    
    gamma * beta))))/(2 * gamma * beta * x) - (-(x - sqrt(theta *    
    (theta + 3 * gamma * beta)))^2) * (2 * beta * x)/(2 * gamma *    
    beta * x)^2) * (2 * (0.5 * (((theta + 3 * gamma * beta) +    
    theta) * (theta * (theta + 3 * gamma * beta))^-0.5) * (x -    
    sqrt(theta * (theta + 3 * gamma * beta))))/(2 * gamma * beta *    
    x)) + exp((-(x - sqrt(theta * (theta + 3 * gamma * beta)))^2)/(2 *    
    gamma * beta * x)) * (2 * (0.5 * (3 * beta * (theta * (theta +    
    3 * gamma * beta))^-0.5 + ((theta + 3 * gamma * beta) + theta) *    
    (-0.5 * (theta * (3 * beta) * (theta * (theta + 3 * gamma *    
        beta))^-1.5))) * (x - sqrt(theta * (theta + 3 * gamma *    
    beta))) - 0.5 * (((theta + 3 * gamma * beta) + theta) * (theta *    
    (theta + 3 * gamma * beta))^-0.5) * (0.5 * (theta * (3 *    
    beta) * (theta * (theta + 3 * gamma * beta))^-0.5)))/(2 *    
    gamma * beta * x) - 2 * (0.5 * (((theta + 3 * gamma * beta) +    
    theta) * (theta * (theta + 3 * gamma * beta))^-0.5) * (x -    
    sqrt(theta * (theta + 3 * gamma * beta)))) * (2 * beta *    
    x)/(2 * gamma * beta * x)^2)))))/(p * sqrt((theta * (theta +    
    3 * gamma))/(2 * pi * gamma * (x^3))) * exp((-(x - sqrt(theta *    
    (theta + 3 * gamma)))^2)/(2 * gamma * x)) + +(1 - p) * sqrt((theta *    
    (theta + 3 * gamma * beta))/(2 * pi * gamma * beta * (x^3))) *    
    exp((-(x - sqrt(theta * (theta + 3 * gamma * beta)))^2)/(2 *    
        gamma * beta * x))) - (p * (0.5 * (((theta + 3 * gamma) +    
    theta)/(2 * pi * gamma * (x^3)) * ((theta * (theta + 3 *    
    gamma))/(2 * pi * gamma * (x^3)))^-0.5)) * exp((-(x - sqrt(theta *    
    (theta + 3 * gamma)))^2)/(2 * gamma * x)) + p * sqrt((theta *    
    (theta + 3 * gamma))/(2 * pi * gamma * (x^3))) * (exp((-(x -    
    sqrt(theta * (theta + 3 * gamma)))^2)/(2 * gamma * x)) *    
    (2 * (0.5 * (((theta + 3 * gamma) + theta) * (theta * (theta +    
        3 * gamma))^-0.5) * (x - sqrt(theta * (theta + 3 * gamma))))/(2 *    
        gamma * x))) + (+(1 - p) * (0.5 * (((theta + 3 * gamma *    
    beta) + theta)/(2 * pi * gamma * beta * (x^3)) * ((theta *    
    (theta + 3 * gamma * beta))/(2 * pi * gamma * beta * (x^3)))^-0.5)) *    
    exp((-(x - sqrt(theta * (theta + 3 * gamma * beta)))^2)/(2 *    
        gamma * beta * x)) + +(1 - p) * sqrt((theta * (theta +    
    3 * gamma * beta))/(2 * pi * gamma * beta * (x^3))) * (exp((-(x -    
    sqrt(theta * (theta + 3 * gamma * beta)))^2)/(2 * gamma *    
    beta * x)) * (2 * (0.5 * (((theta + 3 * gamma * beta) + theta) *    
    (theta * (theta + 3 * gamma * beta))^-0.5) * (x - sqrt(theta *    
    (theta + 3 * gamma * beta))))/(2 * gamma * beta * x))))) *    
    (p * (0.5 * ((theta * 3/(2 * pi * gamma * (x^3)) - (theta *    
        (theta + 3 * gamma)) * (2 * pi * (x^3))/(2 * pi * gamma *    
        (x^3))^2) * ((theta * (theta + 3 * gamma))/(2 * pi *    
        gamma * (x^3)))^-0.5)) * exp((-(x - sqrt(theta * (theta +    
        3 * gamma)))^2)/(2 * gamma * x)) + p * sqrt((theta *    
        (theta + 3 * gamma))/(2 * pi * gamma * (x^3))) * (exp((-(x -    
        sqrt(theta * (theta + 3 * gamma)))^2)/(2 * gamma * x)) *    
        (2 * (0.5 * (theta * 3 * (theta * (theta + 3 * gamma))^-0.5) *    
            (x - sqrt(theta * (theta + 3 * gamma))))/(2 * gamma *    
            x) - (-(x - sqrt(theta * (theta + 3 * gamma)))^2) *    
            (2 * x)/(2 * gamma * x)^2)) + (+(1 - p) * (0.5 *    
        ((theta * (3 * beta)/(2 * pi * gamma * beta * (x^3)) -    
            (theta * (theta + 3 * gamma * beta)) * (2 * pi *    
                beta * (x^3))/(2 * pi * gamma * beta * (x^3))^2) *    
            ((theta * (theta + 3 * gamma * beta))/(2 * pi * gamma *    
                beta * (x^3)))^-0.5)) * exp((-(x - sqrt(theta *    
        (theta + 3 * gamma * beta)))^2)/(2 * gamma * beta * x)) +    
        +(1 - p) * sqrt((theta * (theta + 3 * gamma * beta))/(2 *    
            pi * gamma * beta * (x^3))) * (exp((-(x - sqrt(theta *    
            (theta + 3 * gamma * beta)))^2)/(2 * gamma * beta *    
            x)) * (2 * (0.5 * (theta * (3 * beta) * (theta *    
            (theta + 3 * gamma * beta))^-0.5) * (x - sqrt(theta *    
            (theta + 3 * gamma * beta))))/(2 * gamma * beta *    
            x) - (-(x - sqrt(theta * (theta + 3 * gamma * beta)))^2) *    
            (2 * beta * x)/(2 * gamma * beta * x)^2))))/(p *    
    sqrt((theta * (theta + 3 * gamma))/(2 * pi * gamma * (x^3))) *    
    exp((-(x - sqrt(theta * (theta + 3 * gamma)))^2)/(2 * gamma *    
        x)) + +(1 - p) * sqrt((theta * (theta + 3 * gamma * beta))/(2 *    
    pi * gamma * beta * (x^3))) * exp((-(x - sqrt(theta * (theta +    
    3 * gamma * beta)))^2)/(2 * gamma * beta * x)))^2   
     
     
  dthetap <- ((0.5 * (((theta + 3 * gamma) + theta)/(2 * pi * gamma * (x^3)) *    
    ((theta * (theta + 3 * gamma))/(2 * pi * gamma * (x^3)))^-0.5)) *    
    exp((-(x - sqrt(theta * (theta + 3 * gamma)))^2)/(2 * gamma *    
        x)) + sqrt((theta * (theta + 3 * gamma))/(2 * pi * gamma *    
    (x^3))) * (exp((-(x - sqrt(theta * (theta + 3 * gamma)))^2)/(2 *    
    gamma * x)) * (2 * (0.5 * (((theta + 3 * gamma) + theta) *    
    (theta * (theta + 3 * gamma))^-0.5) * (x - sqrt(theta * (theta +    
    3 * gamma))))/(2 * gamma * x))) - (sqrt((theta * (theta +    
    3 * gamma * beta))/(2 * pi * gamma * beta * (x^3))) * (exp((-(x -    
    sqrt(theta * (theta + 3 * gamma * beta)))^2)/(2 * gamma *    
    beta * x)) * (2 * (0.5 * (((theta + 3 * gamma * beta) + theta) *    
    (theta * (theta + 3 * gamma * beta))^-0.5) * (x - sqrt(theta *    
    (theta + 3 * gamma * beta))))/(2 * gamma * beta * x))) +    
    (0.5 * (((theta + 3 * gamma * beta) + theta)/(2 * pi * gamma *    
        beta * (x^3)) * ((theta * (theta + 3 * gamma * beta))/(2 *    
        pi * gamma * beta * (x^3)))^-0.5)) * exp((-(x - sqrt(theta *    
        (theta + 3 * gamma * beta)))^2)/(2 * gamma * beta * x))))/(p *    
    sqrt((theta * (theta + 3 * gamma))/(2 * pi * gamma * (x^3))) *    
    exp((-(x - sqrt(theta * (theta + 3 * gamma)))^2)/(2 * gamma *    
        x)) + +(1 - p) * sqrt((theta * (theta + 3 * gamma * beta))/(2 *    
    pi * gamma * beta * (x^3))) * exp((-(x - sqrt(theta * (theta +    
    3 * gamma * beta)))^2)/(2 * gamma * beta * x))) - (p * (0.5 *    
    (((theta + 3 * gamma) + theta)/(2 * pi * gamma * (x^3)) *    
        ((theta * (theta + 3 * gamma))/(2 * pi * gamma * (x^3)))^-0.5)) *    
    exp((-(x - sqrt(theta * (theta + 3 * gamma)))^2)/(2 * gamma *    
        x)) + p * sqrt((theta * (theta + 3 * gamma))/(2 * pi *    
    gamma * (x^3))) * (exp((-(x - sqrt(theta * (theta + 3 * gamma)))^2)/(2 *    
    gamma * x)) * (2 * (0.5 * (((theta + 3 * gamma) + theta) *    
    (theta * (theta + 3 * gamma))^-0.5) * (x - sqrt(theta * (theta +    
    3 * gamma))))/(2 * gamma * x))) + (+(1 - p) * (0.5 * (((theta +    
    3 * gamma * beta) + theta)/(2 * pi * gamma * beta * (x^3)) *    
    ((theta * (theta + 3 * gamma * beta))/(2 * pi * gamma * beta *    
        (x^3)))^-0.5)) * exp((-(x - sqrt(theta * (theta + 3 *    
    gamma * beta)))^2)/(2 * gamma * beta * x)) + +(1 - p) * sqrt((theta *    
    (theta + 3 * gamma * beta))/(2 * pi * gamma * beta * (x^3))) *    
    (exp((-(x - sqrt(theta * (theta + 3 * gamma * beta)))^2)/(2 *    
        gamma * beta * x)) * (2 * (0.5 * (((theta + 3 * gamma *    
        beta) + theta) * (theta * (theta + 3 * gamma * beta))^-0.5) *    
        (x - sqrt(theta * (theta + 3 * gamma * beta))))/(2 *    
        gamma * beta * x))))) * (sqrt((theta * (theta + 3 * gamma))/(2 *    
    pi * gamma * (x^3))) * exp((-(x - sqrt(theta * (theta + 3 *    
    gamma)))^2)/(2 * gamma * x)) - sqrt((theta * (theta + 3 *    
    gamma * beta))/(2 * pi * gamma * beta * (x^3))) * exp((-(x -    
    sqrt(theta * (theta + 3 * gamma * beta)))^2)/(2 * gamma *    
    beta * x)))/(p * sqrt((theta * (theta + 3 * gamma))/(2 *    
    pi * gamma * (x^3))) * exp((-(x - sqrt(theta * (theta + 3 *    
    gamma)))^2)/(2 * gamma * x)) + +(1 - p) * sqrt((theta * (theta +    
    3 * gamma * beta))/(2 * pi * gamma * beta * (x^3))) * exp((-(x -    
    sqrt(theta * (theta + 3 * gamma * beta)))^2)/(2 * gamma *    
    beta * x)))^2   
     
  dthetabeta <- (+(1 - p) * (0.5 * ((3 * gamma/(2 * pi * gamma * beta * (x^3)) -    
    ((theta + 3 * gamma * beta) + theta) * (2 * pi * gamma *    
        (x^3))/(2 * pi * gamma * beta * (x^3))^2) * ((theta *    
    (theta + 3 * gamma * beta))/(2 * pi * gamma * beta * (x^3)))^-0.5 +    
    ((theta + 3 * gamma * beta) + theta)/(2 * pi * gamma * beta *    
        (x^3)) * (-0.5 * ((theta * (3 * gamma)/(2 * pi * gamma *    
        beta * (x^3)) - (theta * (theta + 3 * gamma * beta)) *    
        (2 * pi * gamma * (x^3))/(2 * pi * gamma * beta * (x^3))^2) *    
        ((theta * (theta + 3 * gamma * beta))/(2 * pi * gamma *    
            beta * (x^3)))^-1.5)))) * exp((-(x - sqrt(theta *    
    (theta + 3 * gamma * beta)))^2)/(2 * gamma * beta * x)) +    
    +(1 - p) * (0.5 * (((theta + 3 * gamma * beta) + theta)/(2 *    
        pi * gamma * beta * (x^3)) * ((theta * (theta + 3 * gamma *    
        beta))/(2 * pi * gamma * beta * (x^3)))^-0.5)) * (exp((-(x -    
        sqrt(theta * (theta + 3 * gamma * beta)))^2)/(2 * gamma *    
        beta * x)) * (2 * (0.5 * (theta * (3 * gamma) * (theta *    
        (theta + 3 * gamma * beta))^-0.5) * (x - sqrt(theta *    
        (theta + 3 * gamma * beta))))/(2 * gamma * beta * x) -    
        (-(x - sqrt(theta * (theta + 3 * gamma * beta)))^2) *    
            (2 * gamma * x)/(2 * gamma * beta * x)^2)) + (+(1 -    
    p) * (0.5 * ((theta * (3 * gamma)/(2 * pi * gamma * beta *    
    (x^3)) - (theta * (theta + 3 * gamma * beta)) * (2 * pi *    
    gamma * (x^3))/(2 * pi * gamma * beta * (x^3))^2) * ((theta *    
    (theta + 3 * gamma * beta))/(2 * pi * gamma * beta * (x^3)))^-0.5)) *    
    (exp((-(x - sqrt(theta * (theta + 3 * gamma * beta)))^2)/(2 *    
        gamma * beta * x)) * (2 * (0.5 * (((theta + 3 * gamma *    
        beta) + theta) * (theta * (theta + 3 * gamma * beta))^-0.5) *    
        (x - sqrt(theta * (theta + 3 * gamma * beta))))/(2 *    
        gamma * beta * x))) + +(1 - p) * sqrt((theta * (theta +    
    3 * gamma * beta))/(2 * pi * gamma * beta * (x^3))) * (exp((-(x -    
    sqrt(theta * (theta + 3 * gamma * beta)))^2)/(2 * gamma *    
    beta * x)) * (2 * (0.5 * (theta * (3 * gamma) * (theta *    
    (theta + 3 * gamma * beta))^-0.5) * (x - sqrt(theta * (theta +    
    3 * gamma * beta))))/(2 * gamma * beta * x) - (-(x - sqrt(theta *    
    (theta + 3 * gamma * beta)))^2) * (2 * gamma * x)/(2 * gamma *    
    beta * x)^2) * (2 * (0.5 * (((theta + 3 * gamma * beta) +    
    theta) * (theta * (theta + 3 * gamma * beta))^-0.5) * (x -    
    sqrt(theta * (theta + 3 * gamma * beta))))/(2 * gamma * beta *    
    x)) + exp((-(x - sqrt(theta * (theta + 3 * gamma * beta)))^2)/(2 *    
    gamma * beta * x)) * (2 * (0.5 * (3 * gamma * (theta * (theta +    
    3 * gamma * beta))^-0.5 + ((theta + 3 * gamma * beta) + theta) *    
    (-0.5 * (theta * (3 * gamma) * (theta * (theta + 3 * gamma *    
        beta))^-1.5))) * (x - sqrt(theta * (theta + 3 * gamma *    
    beta))) - 0.5 * (((theta + 3 * gamma * beta) + theta) * (theta *    
    (theta + 3 * gamma * beta))^-0.5) * (0.5 * (theta * (3 *    
    gamma) * (theta * (theta + 3 * gamma * beta))^-0.5)))/(2 *    
    gamma * beta * x) - 2 * (0.5 * (((theta + 3 * gamma * beta) +    
    theta) * (theta * (theta + 3 * gamma * beta))^-0.5) * (x -    
    sqrt(theta * (theta + 3 * gamma * beta)))) * (2 * gamma *    
    x)/(2 * gamma * beta * x)^2))))/(p * sqrt((theta * (theta +    
    3 * gamma))/(2 * pi * gamma * (x^3))) * exp((-(x - sqrt(theta *    
    (theta + 3 * gamma)))^2)/(2 * gamma * x)) + +(1 - p) * sqrt((theta *    
    (theta + 3 * gamma * beta))/(2 * pi * gamma * beta * (x^3))) *    
    exp((-(x - sqrt(theta * (theta + 3 * gamma * beta)))^2)/(2 *    
        gamma * beta * x))) - (p * (0.5 * (((theta + 3 * gamma) +    
    theta)/(2 * pi * gamma * (x^3)) * ((theta * (theta + 3 *    
    gamma))/(2 * pi * gamma * (x^3)))^-0.5)) * exp((-(x - sqrt(theta *    
    (theta + 3 * gamma)))^2)/(2 * gamma * x)) + p * sqrt((theta *    
    (theta + 3 * gamma))/(2 * pi * gamma * (x^3))) * (exp((-(x -    
    sqrt(theta * (theta + 3 * gamma)))^2)/(2 * gamma * x)) *    
    (2 * (0.5 * (((theta + 3 * gamma) + theta) * (theta * (theta +    
        3 * gamma))^-0.5) * (x - sqrt(theta * (theta + 3 * gamma))))/(2 *    
        gamma * x))) + (+(1 - p) * (0.5 * (((theta + 3 * gamma *    
    beta) + theta)/(2 * pi * gamma * beta * (x^3)) * ((theta *    
    (theta + 3 * gamma * beta))/(2 * pi * gamma * beta * (x^3)))^-0.5)) *    
    exp((-(x - sqrt(theta * (theta + 3 * gamma * beta)))^2)/(2 *    
        gamma * beta * x)) + +(1 - p) * sqrt((theta * (theta +    
    3 * gamma * beta))/(2 * pi * gamma * beta * (x^3))) * (exp((-(x -    
    sqrt(theta * (theta + 3 * gamma * beta)))^2)/(2 * gamma *    
    beta * x)) * (2 * (0.5 * (((theta + 3 * gamma * beta) + theta) *    
    (theta * (theta + 3 * gamma * beta))^-0.5) * (x - sqrt(theta *    
    (theta + 3 * gamma * beta))))/(2 * gamma * beta * x))))) *    
    (+(1 - p) * (0.5 * ((theta * (3 * gamma)/(2 * pi * gamma *    
        beta * (x^3)) - (theta * (theta + 3 * gamma * beta)) *    
        (2 * pi * gamma * (x^3))/(2 * pi * gamma * beta * (x^3))^2) *    
        ((theta * (theta + 3 * gamma * beta))/(2 * pi * gamma *    
            beta * (x^3)))^-0.5)) * exp((-(x - sqrt(theta * (theta +    
        3 * gamma * beta)))^2)/(2 * gamma * beta * x)) + +(1 -    
        p) * sqrt((theta * (theta + 3 * gamma * beta))/(2 * pi *    
        gamma * beta * (x^3))) * (exp((-(x - sqrt(theta * (theta +    
        3 * gamma * beta)))^2)/(2 * gamma * beta * x)) * (2 *    
        (0.5 * (theta * (3 * gamma) * (theta * (theta + 3 * gamma *    
            beta))^-0.5) * (x - sqrt(theta * (theta + 3 * gamma *    
            beta))))/(2 * gamma * beta * x) - (-(x - sqrt(theta *    
        (theta + 3 * gamma * beta)))^2) * (2 * gamma * x)/(2 *    
        gamma * beta * x)^2)))/(p * sqrt((theta * (theta + 3 *    
    gamma))/(2 * pi * gamma * (x^3))) * exp((-(x - sqrt(theta *    
    (theta + 3 * gamma)))^2)/(2 * gamma * x)) + +(1 - p) * sqrt((theta *    
    (theta + 3 * gamma * beta))/(2 * pi * gamma * beta * (x^3))) *    
    exp((-(x - sqrt(theta * (theta + 3 * gamma * beta)))^2)/(2 *    
        gamma * beta * x)))^2   
     
     
  dgammatheta <- (p * (0.5 * ((3/(2 * pi * gamma * (x^3)) - ((theta + 3 * gamma) +    
    theta) * (2 * pi * (x^3))/(2 * pi * gamma * (x^3))^2) * ((theta *    
    (theta + 3 * gamma))/(2 * pi * gamma * (x^3)))^-0.5 + (theta *    
    3/(2 * pi * gamma * (x^3)) - (theta * (theta + 3 * gamma)) *    
    (2 * pi * (x^3))/(2 * pi * gamma * (x^3))^2) * (-0.5 * (((theta +    
    3 * gamma) + theta)/(2 * pi * gamma * (x^3)) * ((theta *    
    (theta + 3 * gamma))/(2 * pi * gamma * (x^3)))^-1.5)))) *    
    exp((-(x - sqrt(theta * (theta + 3 * gamma)))^2)/(2 * gamma *    
        x)) + p * (0.5 * ((theta * 3/(2 * pi * gamma * (x^3)) -    
    (theta * (theta + 3 * gamma)) * (2 * pi * (x^3))/(2 * pi *    
        gamma * (x^3))^2) * ((theta * (theta + 3 * gamma))/(2 *    
    pi * gamma * (x^3)))^-0.5)) * (exp((-(x - sqrt(theta * (theta +    
    3 * gamma)))^2)/(2 * gamma * x)) * (2 * (0.5 * (((theta +    
    3 * gamma) + theta) * (theta * (theta + 3 * gamma))^-0.5) *    
    (x - sqrt(theta * (theta + 3 * gamma))))/(2 * gamma * x))) +    
    (p * (0.5 * (((theta + 3 * gamma) + theta)/(2 * pi * gamma *    
        (x^3)) * ((theta * (theta + 3 * gamma))/(2 * pi * gamma *    
        (x^3)))^-0.5)) * (exp((-(x - sqrt(theta * (theta + 3 *    
        gamma)))^2)/(2 * gamma * x)) * (2 * (0.5 * (theta * 3 *    
        (theta * (theta + 3 * gamma))^-0.5) * (x - sqrt(theta *    
        (theta + 3 * gamma))))/(2 * gamma * x) - (-(x - sqrt(theta *    
        (theta + 3 * gamma)))^2) * (2 * x)/(2 * gamma * x)^2)) +    
        p * sqrt((theta * (theta + 3 * gamma))/(2 * pi * gamma *    
            (x^3))) * (exp((-(x - sqrt(theta * (theta + 3 * gamma)))^2)/(2 *    
            gamma * x)) * (2 * (0.5 * (((theta + 3 * gamma) +    
            theta) * (theta * (theta + 3 * gamma))^-0.5) * (x -    
            sqrt(theta * (theta + 3 * gamma))))/(2 * gamma *    
            x)) * (2 * (0.5 * (theta * 3 * (theta * (theta +    
            3 * gamma))^-0.5) * (x - sqrt(theta * (theta + 3 *    
            gamma))))/(2 * gamma * x) - (-(x - sqrt(theta * (theta +    
            3 * gamma)))^2) * (2 * x)/(2 * gamma * x)^2) + exp((-(x -    
            sqrt(theta * (theta + 3 * gamma)))^2)/(2 * gamma *    
            x)) * (2 * (0.5 * (3 * (theta * (theta + 3 * gamma))^-0.5 +    
            theta * 3 * (-0.5 * (((theta + 3 * gamma) + theta) *    
                (theta * (theta + 3 * gamma))^-1.5))) * (x -    
            sqrt(theta * (theta + 3 * gamma))) - 0.5 * (theta *    
            3 * (theta * (theta + 3 * gamma))^-0.5) * (0.5 *    
            (((theta + 3 * gamma) + theta) * (theta * (theta +    
                3 * gamma))^-0.5)))/(2 * gamma * x) - 2 * (0.5 *    
            (((theta + 3 * gamma) + theta) * (theta * (theta +    
                3 * gamma))^-0.5) * (x - sqrt(theta * (theta +    
            3 * gamma)))) * (2 * x)/(2 * gamma * x)^2))) + (+(1 -    
    p) * (0.5 * (((3 * beta)/(2 * pi * gamma * beta * (x^3)) -    
    ((theta + 3 * gamma * beta) + theta) * (2 * pi * beta * (x^3))/(2 *    
        pi * gamma * beta * (x^3))^2) * ((theta * (theta + 3 *    
    gamma * beta))/(2 * pi * gamma * beta * (x^3)))^-0.5 + (theta *    
    (3 * beta)/(2 * pi * gamma * beta * (x^3)) - (theta * (theta +    
    3 * gamma * beta)) * (2 * pi * beta * (x^3))/(2 * pi * gamma *    
    beta * (x^3))^2) * (-0.5 * (((theta + 3 * gamma * beta) +    
    theta)/(2 * pi * gamma * beta * (x^3)) * ((theta * (theta +    
    3 * gamma * beta))/(2 * pi * gamma * beta * (x^3)))^-1.5)))) *    
    exp((-(x - sqrt(theta * (theta + 3 * gamma * beta)))^2)/(2 *    
        gamma * beta * x)) + +(1 - p) * (0.5 * ((theta * (3 *    
    beta)/(2 * pi * gamma * beta * (x^3)) - (theta * (theta +    
    3 * gamma * beta)) * (2 * pi * beta * (x^3))/(2 * pi * gamma *    
    beta * (x^3))^2) * ((theta * (theta + 3 * gamma * beta))/(2 *    
    pi * gamma * beta * (x^3)))^-0.5)) * (exp((-(x - sqrt(theta *    
    (theta + 3 * gamma * beta)))^2)/(2 * gamma * beta * x)) *    
    (2 * (0.5 * (((theta + 3 * gamma * beta) + theta) * (theta *    
        (theta + 3 * gamma * beta))^-0.5) * (x - sqrt(theta *    
        (theta + 3 * gamma * beta))))/(2 * gamma * beta * x))) +    
    (+(1 - p) * (0.5 * (((theta + 3 * gamma * beta) + theta)/(2 *    
        pi * gamma * beta * (x^3)) * ((theta * (theta + 3 * gamma *    
        beta))/(2 * pi * gamma * beta * (x^3)))^-0.5)) * (exp((-(x -    
        sqrt(theta * (theta + 3 * gamma * beta)))^2)/(2 * gamma *    
        beta * x)) * (2 * (0.5 * (theta * (3 * beta) * (theta *    
        (theta + 3 * gamma * beta))^-0.5) * (x - sqrt(theta *    
        (theta + 3 * gamma * beta))))/(2 * gamma * beta * x) -    
        (-(x - sqrt(theta * (theta + 3 * gamma * beta)))^2) *    
            (2 * beta * x)/(2 * gamma * beta * x)^2)) + +(1 -    
        p) * sqrt((theta * (theta + 3 * gamma * beta))/(2 * pi *    
        gamma * beta * (x^3))) * (exp((-(x - sqrt(theta * (theta +    
        3 * gamma * beta)))^2)/(2 * gamma * beta * x)) * (2 *    
        (0.5 * (((theta + 3 * gamma * beta) + theta) * (theta *    
            (theta + 3 * gamma * beta))^-0.5) * (x - sqrt(theta *    
            (theta + 3 * gamma * beta))))/(2 * gamma * beta *    
        x)) * (2 * (0.5 * (theta * (3 * beta) * (theta * (theta +    
        3 * gamma * beta))^-0.5) * (x - sqrt(theta * (theta +    
        3 * gamma * beta))))/(2 * gamma * beta * x) - (-(x -    
        sqrt(theta * (theta + 3 * gamma * beta)))^2) * (2 * beta *    
        x)/(2 * gamma * beta * x)^2) + exp((-(x - sqrt(theta *    
        (theta + 3 * gamma * beta)))^2)/(2 * gamma * beta * x)) *    
        (2 * (0.5 * ((3 * beta) * (theta * (theta + 3 * gamma *    
            beta))^-0.5 + theta * (3 * beta) * (-0.5 * (((theta +    
            3 * gamma * beta) + theta) * (theta * (theta + 3 *    
            gamma * beta))^-1.5))) * (x - sqrt(theta * (theta +    
            3 * gamma * beta))) - 0.5 * (theta * (3 * beta) *    
            (theta * (theta + 3 * gamma * beta))^-0.5) * (0.5 *    
            (((theta + 3 * gamma * beta) + theta) * (theta *    
                (theta + 3 * gamma * beta))^-0.5)))/(2 * gamma *    
            beta * x) - 2 * (0.5 * (((theta + 3 * gamma * beta) +    
            theta) * (theta * (theta + 3 * gamma * beta))^-0.5) *    
            (x - sqrt(theta * (theta + 3 * gamma * beta)))) *    
            (2 * beta * x)/(2 * gamma * beta * x)^2)))))/(p *    
    sqrt((theta * (theta + 3 * gamma))/(2 * pi * gamma * (x^3))) *    
    exp((-(x - sqrt(theta * (theta + 3 * gamma)))^2)/(2 * gamma *    
        x)) + +(1 - p) * sqrt((theta * (theta + 3 * gamma * beta))/(2 *    
    pi * gamma * beta * (x^3))) * exp((-(x - sqrt(theta * (theta +    
    3 * gamma * beta)))^2)/(2 * gamma * beta * x))) - (p * (0.5 *    
    ((theta * 3/(2 * pi * gamma * (x^3)) - (theta * (theta +    
        3 * gamma)) * (2 * pi * (x^3))/(2 * pi * gamma * (x^3))^2) *    
        ((theta * (theta + 3 * gamma))/(2 * pi * gamma * (x^3)))^-0.5)) *    
    exp((-(x - sqrt(theta * (theta + 3 * gamma)))^2)/(2 * gamma *    
        x)) + p * sqrt((theta * (theta + 3 * gamma))/(2 * pi *    
    gamma * (x^3))) * (exp((-(x - sqrt(theta * (theta + 3 * gamma)))^2)/(2 *    
    gamma * x)) * (2 * (0.5 * (theta * 3 * (theta * (theta +    
    3 * gamma))^-0.5) * (x - sqrt(theta * (theta + 3 * gamma))))/(2 *    
    gamma * x) - (-(x - sqrt(theta * (theta + 3 * gamma)))^2) *    
    (2 * x)/(2 * gamma * x)^2)) + (+(1 - p) * (0.5 * ((theta *    
    (3 * beta)/(2 * pi * gamma * beta * (x^3)) - (theta * (theta +    
    3 * gamma * beta)) * (2 * pi * beta * (x^3))/(2 * pi * gamma *    
    beta * (x^3))^2) * ((theta * (theta + 3 * gamma * beta))/(2 *    
    pi * gamma * beta * (x^3)))^-0.5)) * exp((-(x - sqrt(theta *    
    (theta + 3 * gamma * beta)))^2)/(2 * gamma * beta * x)) +    
    +(1 - p) * sqrt((theta * (theta + 3 * gamma * beta))/(2 *    
        pi * gamma * beta * (x^3))) * (exp((-(x - sqrt(theta *    
        (theta + 3 * gamma * beta)))^2)/(2 * gamma * beta * x)) *    
        (2 * (0.5 * (theta * (3 * beta) * (theta * (theta + 3 *    
            gamma * beta))^-0.5) * (x - sqrt(theta * (theta +    
            3 * gamma * beta))))/(2 * gamma * beta * x) - (-(x -    
            sqrt(theta * (theta + 3 * gamma * beta)))^2) * (2 *    
            beta * x)/(2 * gamma * beta * x)^2)))) * (p * (0.5 *    
    (((theta + 3 * gamma) + theta)/(2 * pi * gamma * (x^3)) *    
        ((theta * (theta + 3 * gamma))/(2 * pi * gamma * (x^3)))^-0.5)) *    
    exp((-(x - sqrt(theta * (theta + 3 * gamma)))^2)/(2 * gamma *    
        x)) + p * sqrt((theta * (theta + 3 * gamma))/(2 * pi *    
    gamma * (x^3))) * (exp((-(x - sqrt(theta * (theta + 3 * gamma)))^2)/(2 *    
    gamma * x)) * (2 * (0.5 * (((theta + 3 * gamma) + theta) *    
    (theta * (theta + 3 * gamma))^-0.5) * (x - sqrt(theta * (theta +    
    3 * gamma))))/(2 * gamma * x))) + (+(1 - p) * (0.5 * (((theta +    
    3 * gamma * beta) + theta)/(2 * pi * gamma * beta * (x^3)) *    
    ((theta * (theta + 3 * gamma * beta))/(2 * pi * gamma * beta *    
        (x^3)))^-0.5)) * exp((-(x - sqrt(theta * (theta + 3 *    
    gamma * beta)))^2)/(2 * gamma * beta * x)) + +(1 - p) * sqrt((theta *    
    (theta + 3 * gamma * beta))/(2 * pi * gamma * beta * (x^3))) *    
    (exp((-(x - sqrt(theta * (theta + 3 * gamma * beta)))^2)/(2 *    
        gamma * beta * x)) * (2 * (0.5 * (((theta + 3 * gamma *    
        beta) + theta) * (theta * (theta + 3 * gamma * beta))^-0.5) *    
        (x - sqrt(theta * (theta + 3 * gamma * beta))))/(2 *    
        gamma * beta * x)))))/(p * sqrt((theta * (theta + 3 *    
    gamma))/(2 * pi * gamma * (x^3))) * exp((-(x - sqrt(theta *    
    (theta + 3 * gamma)))^2)/(2 * gamma * x)) + +(1 - p) * sqrt((theta *    
    (theta + 3 * gamma * beta))/(2 * pi * gamma * beta * (x^3))) *    
    exp((-(x - sqrt(theta * (theta + 3 * gamma * beta)))^2)/(2 *    
        gamma * beta * x)))^2   
     
  dgammagamma <- (p * (0.5 * ((theta * 3/(2 * pi * gamma * (x^3)) - (theta * (theta +    
    3 * gamma)) * (2 * pi * (x^3))/(2 * pi * gamma * (x^3))^2) *    
    (-0.5 * ((theta * 3/(2 * pi * gamma * (x^3)) - (theta * (theta +    
        3 * gamma)) * (2 * pi * (x^3))/(2 * pi * gamma * (x^3))^2) *    
        ((theta * (theta + 3 * gamma))/(2 * pi * gamma * (x^3)))^-1.5)) -    
    (theta * 3 * (2 * pi * (x^3))/(2 * pi * gamma * (x^3))^2 +    
        (theta * 3 * (2 * pi * (x^3))/(2 * pi * gamma * (x^3))^2 -    
            (theta * (theta + 3 * gamma)) * (2 * pi * (x^3)) *    
                (2 * (2 * pi * (x^3) * (2 * pi * gamma * (x^3))))/((2 *    
                pi * gamma * (x^3))^2)^2)) * ((theta * (theta +    
        3 * gamma))/(2 * pi * gamma * (x^3)))^-0.5)) * exp((-(x -    
    sqrt(theta * (theta + 3 * gamma)))^2)/(2 * gamma * x)) +    
    p * (0.5 * ((theta * 3/(2 * pi * gamma * (x^3)) - (theta *    
        (theta + 3 * gamma)) * (2 * pi * (x^3))/(2 * pi * gamma *    
        (x^3))^2) * ((theta * (theta + 3 * gamma))/(2 * pi *    
        gamma * (x^3)))^-0.5)) * (exp((-(x - sqrt(theta * (theta +    
        3 * gamma)))^2)/(2 * gamma * x)) * (2 * (0.5 * (theta *    
        3 * (theta * (theta + 3 * gamma))^-0.5) * (x - sqrt(theta *    
        (theta + 3 * gamma))))/(2 * gamma * x) - (-(x - sqrt(theta *    
        (theta + 3 * gamma)))^2) * (2 * x)/(2 * gamma * x)^2)) +    
    (p * (0.5 * ((theta * 3/(2 * pi * gamma * (x^3)) - (theta *    
        (theta + 3 * gamma)) * (2 * pi * (x^3))/(2 * pi * gamma *    
        (x^3))^2) * ((theta * (theta + 3 * gamma))/(2 * pi *    
        gamma * (x^3)))^-0.5)) * (exp((-(x - sqrt(theta * (theta +    
        3 * gamma)))^2)/(2 * gamma * x)) * (2 * (0.5 * (theta *    
        3 * (theta * (theta + 3 * gamma))^-0.5) * (x - sqrt(theta *    
        (theta + 3 * gamma))))/(2 * gamma * x) - (-(x - sqrt(theta *    
        (theta + 3 * gamma)))^2) * (2 * x)/(2 * gamma * x)^2)) +    
        p * sqrt((theta * (theta + 3 * gamma))/(2 * pi * gamma *    
            (x^3))) * (exp((-(x - sqrt(theta * (theta + 3 * gamma)))^2)/(2 *    
            gamma * x)) * (2 * (0.5 * (theta * 3 * (theta * (theta +    
            3 * gamma))^-0.5) * (x - sqrt(theta * (theta + 3 *    
            gamma))))/(2 * gamma * x) - (-(x - sqrt(theta * (theta +    
            3 * gamma)))^2) * (2 * x)/(2 * gamma * x)^2) * (2 *    
            (0.5 * (theta * 3 * (theta * (theta + 3 * gamma))^-0.5) *    
                (x - sqrt(theta * (theta + 3 * gamma))))/(2 *    
            gamma * x) - (-(x - sqrt(theta * (theta + 3 * gamma)))^2) *    
            (2 * x)/(2 * gamma * x)^2) + exp((-(x - sqrt(theta *    
            (theta + 3 * gamma)))^2)/(2 * gamma * x)) * (2 *    
            (0.5 * (theta * 3 * (-0.5 * (theta * 3 * (theta *    
                (theta + 3 * gamma))^-1.5))) * (x - sqrt(theta *    
                (theta + 3 * gamma))) - 0.5 * (theta * 3 * (theta *    
                (theta + 3 * gamma))^-0.5) * (0.5 * (theta *    
                3 * (theta * (theta + 3 * gamma))^-0.5)))/(2 *    
            gamma * x) - 2 * (0.5 * (theta * 3 * (theta * (theta +    
            3 * gamma))^-0.5) * (x - sqrt(theta * (theta + 3 *    
            gamma)))) * (2 * x)/(2 * gamma * x)^2 - (2 * (0.5 *    
            (theta * 3 * (theta * (theta + 3 * gamma))^-0.5) *    
            (x - sqrt(theta * (theta + 3 * gamma)))) * (2 * x)/(2 *    
            gamma * x)^2 - (-(x - sqrt(theta * (theta + 3 * gamma)))^2) *    
            (2 * x) * (2 * (2 * x * (2 * gamma * x)))/((2 * gamma *    
            x)^2)^2)))) + (+(1 - p) * (0.5 * ((theta * (3 * beta)/(2 *    
    pi * gamma * beta * (x^3)) - (theta * (theta + 3 * gamma *    
    beta)) * (2 * pi * beta * (x^3))/(2 * pi * gamma * beta *    
    (x^3))^2) * (-0.5 * ((theta * (3 * beta)/(2 * pi * gamma *    
    beta * (x^3)) - (theta * (theta + 3 * gamma * beta)) * (2 *    
    pi * beta * (x^3))/(2 * pi * gamma * beta * (x^3))^2) * ((theta *    
    (theta + 3 * gamma * beta))/(2 * pi * gamma * beta * (x^3)))^-1.5)) -    
    (theta * (3 * beta) * (2 * pi * beta * (x^3))/(2 * pi * gamma *    
        beta * (x^3))^2 + (theta * (3 * beta) * (2 * pi * beta *    
        (x^3))/(2 * pi * gamma * beta * (x^3))^2 - (theta * (theta +    
        3 * gamma * beta)) * (2 * pi * beta * (x^3)) * (2 * (2 *    
        pi * beta * (x^3) * (2 * pi * gamma * beta * (x^3))))/((2 *    
        pi * gamma * beta * (x^3))^2)^2)) * ((theta * (theta +    
        3 * gamma * beta))/(2 * pi * gamma * beta * (x^3)))^-0.5)) *    
    exp((-(x - sqrt(theta * (theta + 3 * gamma * beta)))^2)/(2 *    
        gamma * beta * x)) + +(1 - p) * (0.5 * ((theta * (3 *    
    beta)/(2 * pi * gamma * beta * (x^3)) - (theta * (theta +    
    3 * gamma * beta)) * (2 * pi * beta * (x^3))/(2 * pi * gamma *    
    beta * (x^3))^2) * ((theta * (theta + 3 * gamma * beta))/(2 *    
    pi * gamma * beta * (x^3)))^-0.5)) * (exp((-(x - sqrt(theta *    
    (theta + 3 * gamma * beta)))^2)/(2 * gamma * beta * x)) *    
    (2 * (0.5 * (theta * (3 * beta) * (theta * (theta + 3 * gamma *    
        beta))^-0.5) * (x - sqrt(theta * (theta + 3 * gamma *    
        beta))))/(2 * gamma * beta * x) - (-(x - sqrt(theta *    
        (theta + 3 * gamma * beta)))^2) * (2 * beta * x)/(2 *    
        gamma * beta * x)^2)) + (+(1 - p) * (0.5 * ((theta *    
    (3 * beta)/(2 * pi * gamma * beta * (x^3)) - (theta * (theta +    
    3 * gamma * beta)) * (2 * pi * beta * (x^3))/(2 * pi * gamma *    
    beta * (x^3))^2) * ((theta * (theta + 3 * gamma * beta))/(2 *    
    pi * gamma * beta * (x^3)))^-0.5)) * (exp((-(x - sqrt(theta *    
    (theta + 3 * gamma * beta)))^2)/(2 * gamma * beta * x)) *    
    (2 * (0.5 * (theta * (3 * beta) * (theta * (theta + 3 * gamma *    
        beta))^-0.5) * (x - sqrt(theta * (theta + 3 * gamma *    
        beta))))/(2 * gamma * beta * x) - (-(x - sqrt(theta *    
        (theta + 3 * gamma * beta)))^2) * (2 * beta * x)/(2 *    
        gamma * beta * x)^2)) + +(1 - p) * sqrt((theta * (theta +    
    3 * gamma * beta))/(2 * pi * gamma * beta * (x^3))) * (exp((-(x -    
    sqrt(theta * (theta + 3 * gamma * beta)))^2)/(2 * gamma *    
    beta * x)) * (2 * (0.5 * (theta * (3 * beta) * (theta * (theta +    
    3 * gamma * beta))^-0.5) * (x - sqrt(theta * (theta + 3 *    
    gamma * beta))))/(2 * gamma * beta * x) - (-(x - sqrt(theta *    
    (theta + 3 * gamma * beta)))^2) * (2 * beta * x)/(2 * gamma *    
    beta * x)^2) * (2 * (0.5 * (theta * (3 * beta) * (theta *    
    (theta + 3 * gamma * beta))^-0.5) * (x - sqrt(theta * (theta +    
    3 * gamma * beta))))/(2 * gamma * beta * x) - (-(x - sqrt(theta *    
    (theta + 3 * gamma * beta)))^2) * (2 * beta * x)/(2 * gamma *    
    beta * x)^2) + exp((-(x - sqrt(theta * (theta + 3 * gamma *    
    beta)))^2)/(2 * gamma * beta * x)) * (2 * (0.5 * (theta *    
    (3 * beta) * (-0.5 * (theta * (3 * beta) * (theta * (theta +    
    3 * gamma * beta))^-1.5))) * (x - sqrt(theta * (theta + 3 *    
    gamma * beta))) - 0.5 * (theta * (3 * beta) * (theta * (theta +    
    3 * gamma * beta))^-0.5) * (0.5 * (theta * (3 * beta) * (theta *    
    (theta + 3 * gamma * beta))^-0.5)))/(2 * gamma * beta * x) -    
    2 * (0.5 * (theta * (3 * beta) * (theta * (theta + 3 * gamma *    
        beta))^-0.5) * (x - sqrt(theta * (theta + 3 * gamma *    
        beta)))) * (2 * beta * x)/(2 * gamma * beta * x)^2 -    
    (2 * (0.5 * (theta * (3 * beta) * (theta * (theta + 3 * gamma *    
        beta))^-0.5) * (x - sqrt(theta * (theta + 3 * gamma *    
        beta)))) * (2 * beta * x)/(2 * gamma * beta * x)^2 -    
        (-(x - sqrt(theta * (theta + 3 * gamma * beta)))^2) *    
            (2 * beta * x) * (2 * (2 * beta * x * (2 * gamma *    
            beta * x)))/((2 * gamma * beta * x)^2)^2))))))/(p *    
    sqrt((theta * (theta + 3 * gamma))/(2 * pi * gamma * (x^3))) *    
    exp((-(x - sqrt(theta * (theta + 3 * gamma)))^2)/(2 * gamma *    
        x)) + +(1 - p) * sqrt((theta * (theta + 3 * gamma * beta))/(2 *    
    pi * gamma * beta * (x^3))) * exp((-(x - sqrt(theta * (theta +    
    3 * gamma * beta)))^2)/(2 * gamma * beta * x))) - (p * (0.5 *    
    ((theta * 3/(2 * pi * gamma * (x^3)) - (theta * (theta +    
        3 * gamma)) * (2 * pi * (x^3))/(2 * pi * gamma * (x^3))^2) *    
        ((theta * (theta + 3 * gamma))/(2 * pi * gamma * (x^3)))^-0.5)) *    
    exp((-(x - sqrt(theta * (theta + 3 * gamma)))^2)/(2 * gamma *    
        x)) + p * sqrt((theta * (theta + 3 * gamma))/(2 * pi *    
    gamma * (x^3))) * (exp((-(x - sqrt(theta * (theta + 3 * gamma)))^2)/(2 *    
    gamma * x)) * (2 * (0.5 * (theta * 3 * (theta * (theta +    
    3 * gamma))^-0.5) * (x - sqrt(theta * (theta + 3 * gamma))))/(2 *    
    gamma * x) - (-(x - sqrt(theta * (theta + 3 * gamma)))^2) *    
    (2 * x)/(2 * gamma * x)^2)) + (+(1 - p) * (0.5 * ((theta *    
    (3 * beta)/(2 * pi * gamma * beta * (x^3)) - (theta * (theta +    
    3 * gamma * beta)) * (2 * pi * beta * (x^3))/(2 * pi * gamma *    
    beta * (x^3))^2) * ((theta * (theta + 3 * gamma * beta))/(2 *    
    pi * gamma * beta * (x^3)))^-0.5)) * exp((-(x - sqrt(theta *    
    (theta + 3 * gamma * beta)))^2)/(2 * gamma * beta * x)) +    
    +(1 - p) * sqrt((theta * (theta + 3 * gamma * beta))/(2 *    
        pi * gamma * beta * (x^3))) * (exp((-(x - sqrt(theta *    
        (theta + 3 * gamma * beta)))^2)/(2 * gamma * beta * x)) *    
        (2 * (0.5 * (theta * (3 * beta) * (theta * (theta + 3 *    
            gamma * beta))^-0.5) * (x - sqrt(theta * (theta +    
            3 * gamma * beta))))/(2 * gamma * beta * x) - (-(x -    
            sqrt(theta * (theta + 3 * gamma * beta)))^2) * (2 *    
            beta * x)/(2 * gamma * beta * x)^2)))) * (p * (0.5 *    
    ((theta * 3/(2 * pi * gamma * (x^3)) - (theta * (theta +    
        3 * gamma)) * (2 * pi * (x^3))/(2 * pi * gamma * (x^3))^2) *    
        ((theta * (theta + 3 * gamma))/(2 * pi * gamma * (x^3)))^-0.5)) *    
    exp((-(x - sqrt(theta * (theta + 3 * gamma)))^2)/(2 * gamma *    
        x)) + p * sqrt((theta * (theta + 3 * gamma))/(2 * pi *    
    gamma * (x^3))) * (exp((-(x - sqrt(theta * (theta + 3 * gamma)))^2)/(2 *    
    gamma * x)) * (2 * (0.5 * (theta * 3 * (theta * (theta +    
    3 * gamma))^-0.5) * (x - sqrt(theta * (theta + 3 * gamma))))/(2 *    
    gamma * x) - (-(x - sqrt(theta * (theta + 3 * gamma)))^2) *    
    (2 * x)/(2 * gamma * x)^2)) + (+(1 - p) * (0.5 * ((theta *    
    (3 * beta)/(2 * pi * gamma * beta * (x^3)) - (theta * (theta +    
    3 * gamma * beta)) * (2 * pi * beta * (x^3))/(2 * pi * gamma *    
    beta * (x^3))^2) * ((theta * (theta + 3 * gamma * beta))/(2 *    
    pi * gamma * beta * (x^3)))^-0.5)) * exp((-(x - sqrt(theta *    
    (theta + 3 * gamma * beta)))^2)/(2 * gamma * beta * x)) +    
    +(1 - p) * sqrt((theta * (theta + 3 * gamma * beta))/(2 *    
        pi * gamma * beta * (x^3))) * (exp((-(x - sqrt(theta *    
        (theta + 3 * gamma * beta)))^2)/(2 * gamma * beta * x)) *    
        (2 * (0.5 * (theta * (3 * beta) * (theta * (theta + 3 *    
            gamma * beta))^-0.5) * (x - sqrt(theta * (theta +    
            3 * gamma * beta))))/(2 * gamma * beta * x) - (-(x -    
            sqrt(theta * (theta + 3 * gamma * beta)))^2) * (2 *    
            beta * x)/(2 * gamma * beta * x)^2))))/(p * sqrt((theta *    
    (theta + 3 * gamma))/(2 * pi * gamma * (x^3))) * exp((-(x -    
    sqrt(theta * (theta + 3 * gamma)))^2)/(2 * gamma * x)) +    
    +(1 - p) * sqrt((theta * (theta + 3 * gamma * beta))/(2 *    
        pi * gamma * beta * (x^3))) * exp((-(x - sqrt(theta *    
        (theta + 3 * gamma * beta)))^2)/(2 * gamma * beta * x)))^2   
       
       
       
  dgammap <- ((0.5 * ((theta * 3/(2 * pi * gamma * (x^3)) - (theta * (theta +    
    3 * gamma)) * (2 * pi * (x^3))/(2 * pi * gamma * (x^3))^2) *    
    ((theta * (theta + 3 * gamma))/(2 * pi * gamma * (x^3)))^-0.5)) *    
    exp((-(x - sqrt(theta * (theta + 3 * gamma)))^2)/(2 * gamma *    
        x)) + sqrt((theta * (theta + 3 * gamma))/(2 * pi * gamma *    
    (x^3))) * (exp((-(x - sqrt(theta * (theta + 3 * gamma)))^2)/(2 *    
    gamma * x)) * (2 * (0.5 * (theta * 3 * (theta * (theta +    
    3 * gamma))^-0.5) * (x - sqrt(theta * (theta + 3 * gamma))))/(2 *    
    gamma * x) - (-(x - sqrt(theta * (theta + 3 * gamma)))^2) *    
    (2 * x)/(2 * gamma * x)^2)) - (sqrt((theta * (theta + 3 *    
    gamma * beta))/(2 * pi * gamma * beta * (x^3))) * (exp((-(x -    
    sqrt(theta * (theta + 3 * gamma * beta)))^2)/(2 * gamma *    
    beta * x)) * (2 * (0.5 * (theta * (3 * beta) * (theta * (theta +    
    3 * gamma * beta))^-0.5) * (x - sqrt(theta * (theta + 3 *    
    gamma * beta))))/(2 * gamma * beta * x) - (-(x - sqrt(theta *    
    (theta + 3 * gamma * beta)))^2) * (2 * beta * x)/(2 * gamma *    
    beta * x)^2)) + (0.5 * ((theta * (3 * beta)/(2 * pi * gamma *    
    beta * (x^3)) - (theta * (theta + 3 * gamma * beta)) * (2 *    
    pi * beta * (x^3))/(2 * pi * gamma * beta * (x^3))^2) * ((theta *    
    (theta + 3 * gamma * beta))/(2 * pi * gamma * beta * (x^3)))^-0.5)) *    
    exp((-(x - sqrt(theta * (theta + 3 * gamma * beta)))^2)/(2 *    
        gamma * beta * x))))/(p * sqrt((theta * (theta + 3 *    
    gamma))/(2 * pi * gamma * (x^3))) * exp((-(x - sqrt(theta *    
    (theta + 3 * gamma)))^2)/(2 * gamma * x)) + +(1 - p) * sqrt((theta *    
    (theta + 3 * gamma * beta))/(2 * pi * gamma * beta * (x^3))) *    
    exp((-(x - sqrt(theta * (theta + 3 * gamma * beta)))^2)/(2 *    
        gamma * beta * x))) - (p * (0.5 * ((theta * 3/(2 * pi *    
    gamma * (x^3)) - (theta * (theta + 3 * gamma)) * (2 * pi *    
    (x^3))/(2 * pi * gamma * (x^3))^2) * ((theta * (theta + 3 *    
    gamma))/(2 * pi * gamma * (x^3)))^-0.5)) * exp((-(x - sqrt(theta *    
    (theta + 3 * gamma)))^2)/(2 * gamma * x)) + p * sqrt((theta *    
    (theta + 3 * gamma))/(2 * pi * gamma * (x^3))) * (exp((-(x -    
    sqrt(theta * (theta + 3 * gamma)))^2)/(2 * gamma * x)) *    
    (2 * (0.5 * (theta * 3 * (theta * (theta + 3 * gamma))^-0.5) *    
        (x - sqrt(theta * (theta + 3 * gamma))))/(2 * gamma *    
        x) - (-(x - sqrt(theta * (theta + 3 * gamma)))^2) * (2 *    
        x)/(2 * gamma * x)^2)) + (+(1 - p) * (0.5 * ((theta *    
    (3 * beta)/(2 * pi * gamma * beta * (x^3)) - (theta * (theta +    
    3 * gamma * beta)) * (2 * pi * beta * (x^3))/(2 * pi * gamma *    
    beta * (x^3))^2) * ((theta * (theta + 3 * gamma * beta))/(2 *    
    pi * gamma * beta * (x^3)))^-0.5)) * exp((-(x - sqrt(theta *    
    (theta + 3 * gamma * beta)))^2)/(2 * gamma * beta * x)) +    
    +(1 - p) * sqrt((theta * (theta + 3 * gamma * beta))/(2 *    
        pi * gamma * beta * (x^3))) * (exp((-(x - sqrt(theta *    
        (theta + 3 * gamma * beta)))^2)/(2 * gamma * beta * x)) *    
        (2 * (0.5 * (theta * (3 * beta) * (theta * (theta + 3 *    
            gamma * beta))^-0.5) * (x - sqrt(theta * (theta +    
            3 * gamma * beta))))/(2 * gamma * beta * x) - (-(x -    
            sqrt(theta * (theta + 3 * gamma * beta)))^2) * (2 *    
            beta * x)/(2 * gamma * beta * x)^2)))) * (sqrt((theta *    
    (theta + 3 * gamma))/(2 * pi * gamma * (x^3))) * exp((-(x -    
    sqrt(theta * (theta + 3 * gamma)))^2)/(2 * gamma * x)) -    
    sqrt((theta * (theta + 3 * gamma * beta))/(2 * pi * gamma *    
        beta * (x^3))) * exp((-(x - sqrt(theta * (theta + 3 *    
        gamma * beta)))^2)/(2 * gamma * beta * x)))/(p * sqrt((theta *    
    (theta + 3 * gamma))/(2 * pi * gamma * (x^3))) * exp((-(x -    
    sqrt(theta * (theta + 3 * gamma)))^2)/(2 * gamma * x)) +    
    +(1 - p) * sqrt((theta * (theta + 3 * gamma * beta))/(2 *    
        pi * gamma * beta * (x^3))) * exp((-(x - sqrt(theta *    
        (theta + 3 * gamma * beta)))^2)/(2 * gamma * beta * x)))^2   
       
       
  dgammabeta <- (+(1 - p) * (0.5 * ((theta * 3/(2 * pi * gamma * beta * (x^3)) -    
    theta * (3 * beta) * (2 * pi * gamma * (x^3))/(2 * pi * gamma *    
        beta * (x^3))^2 - ((theta * (3 * gamma) * (2 * pi * beta *    
    (x^3)) + (theta * (theta + 3 * gamma * beta)) * (2 * pi *    
    (x^3)))/(2 * pi * gamma * beta * (x^3))^2 - (theta * (theta +    
    3 * gamma * beta)) * (2 * pi * beta * (x^3)) * (2 * (2 *    
    pi * gamma * (x^3) * (2 * pi * gamma * beta * (x^3))))/((2 *    
    pi * gamma * beta * (x^3))^2)^2)) * ((theta * (theta + 3 *    
    gamma * beta))/(2 * pi * gamma * beta * (x^3)))^-0.5 + (theta *    
    (3 * beta)/(2 * pi * gamma * beta * (x^3)) - (theta * (theta +    
    3 * gamma * beta)) * (2 * pi * beta * (x^3))/(2 * pi * gamma *    
    beta * (x^3))^2) * (-0.5 * ((theta * (3 * gamma)/(2 * pi *    
    gamma * beta * (x^3)) - (theta * (theta + 3 * gamma * beta)) *    
    (2 * pi * gamma * (x^3))/(2 * pi * gamma * beta * (x^3))^2) *    
    ((theta * (theta + 3 * gamma * beta))/(2 * pi * gamma * beta *    
        (x^3)))^-1.5)))) * exp((-(x - sqrt(theta * (theta + 3 *    
    gamma * beta)))^2)/(2 * gamma * beta * x)) + +(1 - p) * (0.5 *    
    ((theta * (3 * beta)/(2 * pi * gamma * beta * (x^3)) - (theta *    
        (theta + 3 * gamma * beta)) * (2 * pi * beta * (x^3))/(2 *    
        pi * gamma * beta * (x^3))^2) * ((theta * (theta + 3 *    
        gamma * beta))/(2 * pi * gamma * beta * (x^3)))^-0.5)) *    
    (exp((-(x - sqrt(theta * (theta + 3 * gamma * beta)))^2)/(2 *    
        gamma * beta * x)) * (2 * (0.5 * (theta * (3 * gamma) *    
        (theta * (theta + 3 * gamma * beta))^-0.5) * (x - sqrt(theta *    
        (theta + 3 * gamma * beta))))/(2 * gamma * beta * x) -    
        (-(x - sqrt(theta * (theta + 3 * gamma * beta)))^2) *    
            (2 * gamma * x)/(2 * gamma * beta * x)^2)) + (+(1 -    
    p) * (0.5 * ((theta * (3 * gamma)/(2 * pi * gamma * beta *    
    (x^3)) - (theta * (theta + 3 * gamma * beta)) * (2 * pi *    
    gamma * (x^3))/(2 * pi * gamma * beta * (x^3))^2) * ((theta *    
    (theta + 3 * gamma * beta))/(2 * pi * gamma * beta * (x^3)))^-0.5)) *    
    (exp((-(x - sqrt(theta * (theta + 3 * gamma * beta)))^2)/(2 *    
        gamma * beta * x)) * (2 * (0.5 * (theta * (3 * beta) *    
        (theta * (theta + 3 * gamma * beta))^-0.5) * (x - sqrt(theta *    
        (theta + 3 * gamma * beta))))/(2 * gamma * beta * x) -    
        (-(x - sqrt(theta * (theta + 3 * gamma * beta)))^2) *    
            (2 * beta * x)/(2 * gamma * beta * x)^2)) + +(1 -    
    p) * sqrt((theta * (theta + 3 * gamma * beta))/(2 * pi *    
    gamma * beta * (x^3))) * (exp((-(x - sqrt(theta * (theta +    
    3 * gamma * beta)))^2)/(2 * gamma * beta * x)) * (2 * (0.5 *    
    (theta * (3 * gamma) * (theta * (theta + 3 * gamma * beta))^-0.5) *    
    (x - sqrt(theta * (theta + 3 * gamma * beta))))/(2 * gamma *    
    beta * x) - (-(x - sqrt(theta * (theta + 3 * gamma * beta)))^2) *    
    (2 * gamma * x)/(2 * gamma * beta * x)^2) * (2 * (0.5 * (theta *    
    (3 * beta) * (theta * (theta + 3 * gamma * beta))^-0.5) *    
    (x - sqrt(theta * (theta + 3 * gamma * beta))))/(2 * gamma *    
    beta * x) - (-(x - sqrt(theta * (theta + 3 * gamma * beta)))^2) *    
    (2 * beta * x)/(2 * gamma * beta * x)^2) + exp((-(x - sqrt(theta *    
    (theta + 3 * gamma * beta)))^2)/(2 * gamma * beta * x)) *    
    (2 * (0.5 * (theta * 3 * (theta * (theta + 3 * gamma * beta))^-0.5 +    
        theta * (3 * beta) * (-0.5 * (theta * (3 * gamma) * (theta *    
            (theta + 3 * gamma * beta))^-1.5))) * (x - sqrt(theta *    
        (theta + 3 * gamma * beta))) - 0.5 * (theta * (3 * beta) *    
        (theta * (theta + 3 * gamma * beta))^-0.5) * (0.5 * (theta *    
        (3 * gamma) * (theta * (theta + 3 * gamma * beta))^-0.5)))/(2 *    
        gamma * beta * x) - 2 * (0.5 * (theta * (3 * beta) *    
        (theta * (theta + 3 * gamma * beta))^-0.5) * (x - sqrt(theta *    
        (theta + 3 * gamma * beta)))) * (2 * gamma * x)/(2 *    
        gamma * beta * x)^2 - ((2 * (0.5 * (theta * (3 * gamma) *    
        (theta * (theta + 3 * gamma * beta))^-0.5) * (x - sqrt(theta *    
        (theta + 3 * gamma * beta)))) * (2 * beta * x) + (-(x -    
        sqrt(theta * (theta + 3 * gamma * beta)))^2) * (2 * x))/(2 *    
        gamma * beta * x)^2 - (-(x - sqrt(theta * (theta + 3 *    
        gamma * beta)))^2) * (2 * beta * x) * (2 * (2 * gamma *    
        x * (2 * gamma * beta * x)))/((2 * gamma * beta * x)^2)^2)))))/(p *    
    sqrt((theta * (theta + 3 * gamma))/(2 * pi * gamma * (x^3))) *    
    exp((-(x - sqrt(theta * (theta + 3 * gamma)))^2)/(2 * gamma *    
        x)) + +(1 - p) * sqrt((theta * (theta + 3 * gamma * beta))/(2 *    
    pi * gamma * beta * (x^3))) * exp((-(x - sqrt(theta * (theta +    
    3 * gamma * beta)))^2)/(2 * gamma * beta * x))) - (p * (0.5 *    
    ((theta * 3/(2 * pi * gamma * (x^3)) - (theta * (theta +    
        3 * gamma)) * (2 * pi * (x^3))/(2 * pi * gamma * (x^3))^2) *    
        ((theta * (theta + 3 * gamma))/(2 * pi * gamma * (x^3)))^-0.5)) *    
    exp((-(x - sqrt(theta * (theta + 3 * gamma)))^2)/(2 * gamma *    
        x)) + p * sqrt((theta * (theta + 3 * gamma))/(2 * pi *    
    gamma * (x^3))) * (exp((-(x - sqrt(theta * (theta + 3 * gamma)))^2)/(2 *    
    gamma * x)) * (2 * (0.5 * (theta * 3 * (theta * (theta +    
    3 * gamma))^-0.5) * (x - sqrt(theta * (theta + 3 * gamma))))/(2 *    
    gamma * x) - (-(x - sqrt(theta * (theta + 3 * gamma)))^2) *    
    (2 * x)/(2 * gamma * x)^2)) + (+(1 - p) * (0.5 * ((theta *    
    (3 * beta)/(2 * pi * gamma * beta * (x^3)) - (theta * (theta +    
    3 * gamma * beta)) * (2 * pi * beta * (x^3))/(2 * pi * gamma *    
    beta * (x^3))^2) * ((theta * (theta + 3 * gamma * beta))/(2 *    
    pi * gamma * beta * (x^3)))^-0.5)) * exp((-(x - sqrt(theta *    
    (theta + 3 * gamma * beta)))^2)/(2 * gamma * beta * x)) +    
    +(1 - p) * sqrt((theta * (theta + 3 * gamma * beta))/(2 *    
        pi * gamma * beta * (x^3))) * (exp((-(x - sqrt(theta *    
        (theta + 3 * gamma * beta)))^2)/(2 * gamma * beta * x)) *    
        (2 * (0.5 * (theta * (3 * beta) * (theta * (theta + 3 *    
            gamma * beta))^-0.5) * (x - sqrt(theta * (theta +    
            3 * gamma * beta))))/(2 * gamma * beta * x) - (-(x -    
            sqrt(theta * (theta + 3 * gamma * beta)))^2) * (2 *    
            beta * x)/(2 * gamma * beta * x)^2)))) * (+(1 - p) *    
    (0.5 * ((theta * (3 * gamma)/(2 * pi * gamma * beta * (x^3)) -    
        (theta * (theta + 3 * gamma * beta)) * (2 * pi * gamma *    
            (x^3))/(2 * pi * gamma * beta * (x^3))^2) * ((theta *    
        (theta + 3 * gamma * beta))/(2 * pi * gamma * beta *    
        (x^3)))^-0.5)) * exp((-(x - sqrt(theta * (theta + 3 *    
    gamma * beta)))^2)/(2 * gamma * beta * x)) + +(1 - p) * sqrt((theta *    
    (theta + 3 * gamma * beta))/(2 * pi * gamma * beta * (x^3))) *    
    (exp((-(x - sqrt(theta * (theta + 3 * gamma * beta)))^2)/(2 *    
        gamma * beta * x)) * (2 * (0.5 * (theta * (3 * gamma) *    
        (theta * (theta + 3 * gamma * beta))^-0.5) * (x - sqrt(theta *    
        (theta + 3 * gamma * beta))))/(2 * gamma * beta * x) -    
        (-(x - sqrt(theta * (theta + 3 * gamma * beta)))^2) *    
            (2 * gamma * x)/(2 * gamma * beta * x)^2)))/(p *    
    sqrt((theta * (theta + 3 * gamma))/(2 * pi * gamma * (x^3))) *    
    exp((-(x - sqrt(theta * (theta + 3 * gamma)))^2)/(2 * gamma *    
        x)) + +(1 - p) * sqrt((theta * (theta + 3 * gamma * beta))/(2 *    
    pi * gamma * beta * (x^3))) * exp((-(x - sqrt(theta * (theta +    
    3 * gamma * beta)))^2)/(2 * gamma * beta * x)))^2   
     
     
     
     
  dptheta <- (0.5 * (((theta + 3 * gamma) + theta)/(2 * pi * gamma * (x^3)) *    
    ((theta * (theta + 3 * gamma))/(2 * pi * gamma * (x^3)))^-0.5) *    
    exp((-(x - sqrt(theta * (theta + 3 * gamma)))^2)/(2 * gamma *    
        x)) + sqrt((theta * (theta + 3 * gamma))/(2 * pi * gamma *    
    (x^3))) * (exp((-(x - sqrt(theta * (theta + 3 * gamma)))^2)/(2 *    
    gamma * x)) * (2 * (0.5 * (((theta + 3 * gamma) + theta) *    
    (theta * (theta + 3 * gamma))^-0.5) * (x - sqrt(theta * (theta +    
    3 * gamma))))/(2 * gamma * x))) - (0.5 * (((theta + 3 * gamma *    
    beta) + theta)/(2 * pi * gamma * beta * (x^3)) * ((theta *    
    (theta + 3 * gamma * beta))/(2 * pi * gamma * beta * (x^3)))^-0.5) *    
    exp((-(x - sqrt(theta * (theta + 3 * gamma * beta)))^2)/(2 *    
        gamma * beta * x)) + sqrt((theta * (theta + 3 * gamma *    
    beta))/(2 * pi * gamma * beta * (x^3))) * (exp((-(x - sqrt(theta *    
    (theta + 3 * gamma * beta)))^2)/(2 * gamma * beta * x)) *    
    (2 * (0.5 * (((theta + 3 * gamma * beta) + theta) * (theta *    
        (theta + 3 * gamma * beta))^-0.5) * (x - sqrt(theta *    
        (theta + 3 * gamma * beta))))/(2 * gamma * beta * x)))))/(p *    
    sqrt((theta * (theta + 3 * gamma))/(2 * pi * gamma * (x^3))) *    
    exp((-(x - sqrt(theta * (theta + 3 * gamma)))^2)/(2 * gamma *    
        x)) + +(1 - p) * sqrt((theta * (theta + 3 * gamma * beta))/(2 *    
    pi * gamma * beta * (x^3))) * exp((-(x - sqrt(theta * (theta +    
    3 * gamma * beta)))^2)/(2 * gamma * beta * x))) - (sqrt((theta *    
    (theta + 3 * gamma))/(2 * pi * gamma * (x^3))) * exp((-(x -    
    sqrt(theta * (theta + 3 * gamma)))^2)/(2 * gamma * x)) -    
    sqrt((theta * (theta + 3 * gamma * beta))/(2 * pi * gamma *    
        beta * (x^3))) * exp((-(x - sqrt(theta * (theta + 3 *    
        gamma * beta)))^2)/(2 * gamma * beta * x))) * (p * (0.5 *    
    (((theta + 3 * gamma) + theta)/(2 * pi * gamma * (x^3)) *    
        ((theta * (theta + 3 * gamma))/(2 * pi * gamma * (x^3)))^-0.5)) *    
    exp((-(x - sqrt(theta * (theta + 3 * gamma)))^2)/(2 * gamma *    
        x)) + p * sqrt((theta * (theta + 3 * gamma))/(2 * pi *    
    gamma * (x^3))) * (exp((-(x - sqrt(theta * (theta + 3 * gamma)))^2)/(2 *    
    gamma * x)) * (2 * (0.5 * (((theta + 3 * gamma) + theta) *    
    (theta * (theta + 3 * gamma))^-0.5) * (x - sqrt(theta * (theta +    
    3 * gamma))))/(2 * gamma * x))) + (+(1 - p) * (0.5 * (((theta +    
    3 * gamma * beta) + theta)/(2 * pi * gamma * beta * (x^3)) *    
    ((theta * (theta + 3 * gamma * beta))/(2 * pi * gamma * beta *    
        (x^3)))^-0.5)) * exp((-(x - sqrt(theta * (theta + 3 *    
    gamma * beta)))^2)/(2 * gamma * beta * x)) + +(1 - p) * sqrt((theta *    
    (theta + 3 * gamma * beta))/(2 * pi * gamma * beta * (x^3))) *    
    (exp((-(x - sqrt(theta * (theta + 3 * gamma * beta)))^2)/(2 *    
        gamma * beta * x)) * (2 * (0.5 * (((theta + 3 * gamma *    
        beta) + theta) * (theta * (theta + 3 * gamma * beta))^-0.5) *    
        (x - sqrt(theta * (theta + 3 * gamma * beta))))/(2 *    
        gamma * beta * x)))))/(p * sqrt((theta * (theta + 3 *    
    gamma))/(2 * pi * gamma * (x^3))) * exp((-(x - sqrt(theta *    
    (theta + 3 * gamma)))^2)/(2 * gamma * x)) + +(1 - p) * sqrt((theta *    
    (theta + 3 * gamma * beta))/(2 * pi * gamma * beta * (x^3))) *    
    exp((-(x - sqrt(theta * (theta + 3 * gamma * beta)))^2)/(2 *    
        gamma * beta * x)))^2   
       
       
  dpgamma <- (0.5 * ((theta * 3/(2 * pi * gamma * (x^3)) - (theta * (theta +    
    3 * gamma)) * (2 * pi * (x^3))/(2 * pi * gamma * (x^3))^2) *    
    ((theta * (theta + 3 * gamma))/(2 * pi * gamma * (x^3)))^-0.5) *    
    exp((-(x - sqrt(theta * (theta + 3 * gamma)))^2)/(2 * gamma *    
        x)) + sqrt((theta * (theta + 3 * gamma))/(2 * pi * gamma *    
    (x^3))) * (exp((-(x - sqrt(theta * (theta + 3 * gamma)))^2)/(2 *    
    gamma * x)) * (2 * (0.5 * (theta * 3 * (theta * (theta +    
    3 * gamma))^-0.5) * (x - sqrt(theta * (theta + 3 * gamma))))/(2 *    
    gamma * x) - (-(x - sqrt(theta * (theta + 3 * gamma)))^2) *    
    (2 * x)/(2 * gamma * x)^2)) - (0.5 * ((theta * (3 * beta)/(2 *    
    pi * gamma * beta * (x^3)) - (theta * (theta + 3 * gamma *    
    beta)) * (2 * pi * beta * (x^3))/(2 * pi * gamma * beta *    
    (x^3))^2) * ((theta * (theta + 3 * gamma * beta))/(2 * pi *    
    gamma * beta * (x^3)))^-0.5) * exp((-(x - sqrt(theta * (theta +    
    3 * gamma * beta)))^2)/(2 * gamma * beta * x)) + sqrt((theta *    
    (theta + 3 * gamma * beta))/(2 * pi * gamma * beta * (x^3))) *    
    (exp((-(x - sqrt(theta * (theta + 3 * gamma * beta)))^2)/(2 *    
        gamma * beta * x)) * (2 * (0.5 * (theta * (3 * beta) *    
        (theta * (theta + 3 * gamma * beta))^-0.5) * (x - sqrt(theta *    
        (theta + 3 * gamma * beta))))/(2 * gamma * beta * x) -    
        (-(x - sqrt(theta * (theta + 3 * gamma * beta)))^2) *    
            (2 * beta * x)/(2 * gamma * beta * x)^2))))/(p *    
    sqrt((theta * (theta + 3 * gamma))/(2 * pi * gamma * (x^3))) *    
    exp((-(x - sqrt(theta * (theta + 3 * gamma)))^2)/(2 * gamma *    
        x)) + +(1 - p) * sqrt((theta * (theta + 3 * gamma * beta))/(2 *    
    pi * gamma * beta * (x^3))) * exp((-(x - sqrt(theta * (theta +    
    3 * gamma * beta)))^2)/(2 * gamma * beta * x))) - (sqrt((theta *    
    (theta + 3 * gamma))/(2 * pi * gamma * (x^3))) * exp((-(x -    
    sqrt(theta * (theta + 3 * gamma)))^2)/(2 * gamma * x)) -    
    sqrt((theta * (theta + 3 * gamma * beta))/(2 * pi * gamma *    
        beta * (x^3))) * exp((-(x - sqrt(theta * (theta + 3 *    
        gamma * beta)))^2)/(2 * gamma * beta * x))) * (p * (0.5 *    
    ((theta * 3/(2 * pi * gamma * (x^3)) - (theta * (theta +    
        3 * gamma)) * (2 * pi * (x^3))/(2 * pi * gamma * (x^3))^2) *    
        ((theta * (theta + 3 * gamma))/(2 * pi * gamma * (x^3)))^-0.5)) *    
    exp((-(x - sqrt(theta * (theta + 3 * gamma)))^2)/(2 * gamma *    
        x)) + p * sqrt((theta * (theta + 3 * gamma))/(2 * pi *    
    gamma * (x^3))) * (exp((-(x - sqrt(theta * (theta + 3 * gamma)))^2)/(2 *    
    gamma * x)) * (2 * (0.5 * (theta * 3 * (theta * (theta +    
    3 * gamma))^-0.5) * (x - sqrt(theta * (theta + 3 * gamma))))/(2 *    
    gamma * x) - (-(x - sqrt(theta * (theta + 3 * gamma)))^2) *    
    (2 * x)/(2 * gamma * x)^2)) + (+(1 - p) * (0.5 * ((theta *    
    (3 * beta)/(2 * pi * gamma * beta * (x^3)) - (theta * (theta +    
    3 * gamma * beta)) * (2 * pi * beta * (x^3))/(2 * pi * gamma *    
    beta * (x^3))^2) * ((theta * (theta + 3 * gamma * beta))/(2 *    
    pi * gamma * beta * (x^3)))^-0.5)) * exp((-(x - sqrt(theta *    
    (theta + 3 * gamma * beta)))^2)/(2 * gamma * beta * x)) +    
    +(1 - p) * sqrt((theta * (theta + 3 * gamma * beta))/(2 *    
        pi * gamma * beta * (x^3))) * (exp((-(x - sqrt(theta *    
        (theta + 3 * gamma * beta)))^2)/(2 * gamma * beta * x)) *    
        (2 * (0.5 * (theta * (3 * beta) * (theta * (theta + 3 *    
            gamma * beta))^-0.5) * (x - sqrt(theta * (theta +    
            3 * gamma * beta))))/(2 * gamma * beta * x) - (-(x -    
            sqrt(theta * (theta + 3 * gamma * beta)))^2) * (2 *    
            beta * x)/(2 * gamma * beta * x)^2))))/(p * sqrt((theta *    
    (theta + 3 * gamma))/(2 * pi * gamma * (x^3))) * exp((-(x -    
    sqrt(theta * (theta + 3 * gamma)))^2)/(2 * gamma * x)) +    
    +(1 - p) * sqrt((theta * (theta + 3 * gamma * beta))/(2 *    
        pi * gamma * beta * (x^3))) * exp((-(x - sqrt(theta *    
        (theta + 3 * gamma * beta)))^2)/(2 * gamma * beta * x)))^2   
       
       
  dpp <- -((sqrt((theta * (theta + 3 * gamma))/(2 * pi * gamma * (x^3))) *    
    exp((-(x - sqrt(theta * (theta + 3 * gamma)))^2)/(2 * gamma *    
        x)) - sqrt((theta * (theta + 3 * gamma * beta))/(2 *    
    pi * gamma * beta * (x^3))) * exp((-(x - sqrt(theta * (theta +    
    3 * gamma * beta)))^2)/(2 * gamma * beta * x))) * (sqrt((theta *    
    (theta + 3 * gamma))/(2 * pi * gamma * (x^3))) * exp((-(x -    
    sqrt(theta * (theta + 3 * gamma)))^2)/(2 * gamma * x)) -    
    sqrt((theta * (theta + 3 * gamma * beta))/(2 * pi * gamma *    
        beta * (x^3))) * exp((-(x - sqrt(theta * (theta + 3 *    
        gamma * beta)))^2)/(2 * gamma * beta * x)))/(p * sqrt((theta *    
    (theta + 3 * gamma))/(2 * pi * gamma * (x^3))) * exp((-(x -    
    sqrt(theta * (theta + 3 * gamma)))^2)/(2 * gamma * x)) +    
    +(1 - p) * sqrt((theta * (theta + 3 * gamma * beta))/(2 *    
        pi * gamma * beta * (x^3))) * exp((-(x - sqrt(theta *    
        (theta + 3 * gamma * beta)))^2)/(2 * gamma * beta * x)))^2)   
       
       
  dpbeta <- -((0.5 * ((theta * (3 * gamma)/(2 * pi * gamma * beta * (x^3)) -    
    (theta * (theta + 3 * gamma * beta)) * (2 * pi * gamma *    
        (x^3))/(2 * pi * gamma * beta * (x^3))^2) * ((theta *    
    (theta + 3 * gamma * beta))/(2 * pi * gamma * beta * (x^3)))^-0.5) *    
    exp((-(x - sqrt(theta * (theta + 3 * gamma * beta)))^2)/(2 *    
        gamma * beta * x)) + sqrt((theta * (theta + 3 * gamma *    
    beta))/(2 * pi * gamma * beta * (x^3))) * (exp((-(x - sqrt(theta *    
    (theta + 3 * gamma * beta)))^2)/(2 * gamma * beta * x)) *    
    (2 * (0.5 * (theta * (3 * gamma) * (theta * (theta + 3 *    
        gamma * beta))^-0.5) * (x - sqrt(theta * (theta + 3 *    
        gamma * beta))))/(2 * gamma * beta * x) - (-(x - sqrt(theta *    
        (theta + 3 * gamma * beta)))^2) * (2 * gamma * x)/(2 *    
        gamma * beta * x)^2)))/(p * sqrt((theta * (theta + 3 *    
    gamma))/(2 * pi * gamma * (x^3))) * exp((-(x - sqrt(theta *    
    (theta + 3 * gamma)))^2)/(2 * gamma * x)) + +(1 - p) * sqrt((theta *    
    (theta + 3 * gamma * beta))/(2 * pi * gamma * beta * (x^3))) *    
    exp((-(x - sqrt(theta * (theta + 3 * gamma * beta)))^2)/(2 *    
        gamma * beta * x))) + (sqrt((theta * (theta + 3 * gamma))/(2 *    
    pi * gamma * (x^3))) * exp((-(x - sqrt(theta * (theta + 3 *    
    gamma)))^2)/(2 * gamma * x)) - sqrt((theta * (theta + 3 *    
    gamma * beta))/(2 * pi * gamma * beta * (x^3))) * exp((-(x -    
    sqrt(theta * (theta + 3 * gamma * beta)))^2)/(2 * gamma *    
    beta * x))) * (+(1 - p) * (0.5 * ((theta * (3 * gamma)/(2 *    
    pi * gamma * beta * (x^3)) - (theta * (theta + 3 * gamma *    
    beta)) * (2 * pi * gamma * (x^3))/(2 * pi * gamma * beta *    
    (x^3))^2) * ((theta * (theta + 3 * gamma * beta))/(2 * pi *    
    gamma * beta * (x^3)))^-0.5)) * exp((-(x - sqrt(theta * (theta +    
    3 * gamma * beta)))^2)/(2 * gamma * beta * x)) + +(1 - p) *    
    sqrt((theta * (theta + 3 * gamma * beta))/(2 * pi * gamma *    
        beta * (x^3))) * (exp((-(x - sqrt(theta * (theta + 3 *    
    gamma * beta)))^2)/(2 * gamma * beta * x)) * (2 * (0.5 *    
    (theta * (3 * gamma) * (theta * (theta + 3 * gamma * beta))^-0.5) *    
    (x - sqrt(theta * (theta + 3 * gamma * beta))))/(2 * gamma *    
    beta * x) - (-(x - sqrt(theta * (theta + 3 * gamma * beta)))^2) *    
    (2 * gamma * x)/(2 * gamma * beta * x)^2)))/(p * sqrt((theta *    
    (theta + 3 * gamma))/(2 * pi * gamma * (x^3))) * exp((-(x -    
    sqrt(theta * (theta + 3 * gamma)))^2)/(2 * gamma * x)) +    
    +(1 - p) * sqrt((theta * (theta + 3 * gamma * beta))/(2 *    
        pi * gamma * beta * (x^3))) * exp((-(x - sqrt(theta *    
        (theta + 3 * gamma * beta)))^2)/(2 * gamma * beta * x)))^2)   
     
     
     
     
  dbetatheta <- (+(1 - p) * (0.5 * (((3 * gamma)/(2 * pi * gamma * beta * (x^3)) -    
    ((theta + 3 * gamma * beta) + theta) * (2 * pi * gamma *    
        (x^3))/(2 * pi * gamma * beta * (x^3))^2) * ((theta *    
    (theta + 3 * gamma * beta))/(2 * pi * gamma * beta * (x^3)))^-0.5 +    
    (theta * (3 * gamma)/(2 * pi * gamma * beta * (x^3)) - (theta *    
        (theta + 3 * gamma * beta)) * (2 * pi * gamma * (x^3))/(2 *    
        pi * gamma * beta * (x^3))^2) * (-0.5 * (((theta + 3 *    
        gamma * beta) + theta)/(2 * pi * gamma * beta * (x^3)) *    
        ((theta * (theta + 3 * gamma * beta))/(2 * pi * gamma *    
            beta * (x^3)))^-1.5)))) * exp((-(x - sqrt(theta *    
    (theta + 3 * gamma * beta)))^2)/(2 * gamma * beta * x)) +    
    +(1 - p) * (0.5 * ((theta * (3 * gamma)/(2 * pi * gamma *    
        beta * (x^3)) - (theta * (theta + 3 * gamma * beta)) *    
        (2 * pi * gamma * (x^3))/(2 * pi * gamma * beta * (x^3))^2) *    
        ((theta * (theta + 3 * gamma * beta))/(2 * pi * gamma *    
            beta * (x^3)))^-0.5)) * (exp((-(x - sqrt(theta *    
        (theta + 3 * gamma * beta)))^2)/(2 * gamma * beta * x)) *    
        (2 * (0.5 * (((theta + 3 * gamma * beta) + theta) * (theta *    
            (theta + 3 * gamma * beta))^-0.5) * (x - sqrt(theta *    
            (theta + 3 * gamma * beta))))/(2 * gamma * beta *    
            x))) + (+(1 - p) * (0.5 * (((theta + 3 * gamma *    
    beta) + theta)/(2 * pi * gamma * beta * (x^3)) * ((theta *    
    (theta + 3 * gamma * beta))/(2 * pi * gamma * beta * (x^3)))^-0.5)) *    
    (exp((-(x - sqrt(theta * (theta + 3 * gamma * beta)))^2)/(2 *    
        gamma * beta * x)) * (2 * (0.5 * (theta * (3 * gamma) *    
        (theta * (theta + 3 * gamma * beta))^-0.5) * (x - sqrt(theta *    
        (theta + 3 * gamma * beta))))/(2 * gamma * beta * x) -    
        (-(x - sqrt(theta * (theta + 3 * gamma * beta)))^2) *    
            (2 * gamma * x)/(2 * gamma * beta * x)^2)) + +(1 -    
    p) * sqrt((theta * (theta + 3 * gamma * beta))/(2 * pi *    
    gamma * beta * (x^3))) * (exp((-(x - sqrt(theta * (theta +    
    3 * gamma * beta)))^2)/(2 * gamma * beta * x)) * (2 * (0.5 *    
    (((theta + 3 * gamma * beta) + theta) * (theta * (theta +    
        3 * gamma * beta))^-0.5) * (x - sqrt(theta * (theta +    
    3 * gamma * beta))))/(2 * gamma * beta * x)) * (2 * (0.5 *    
    (theta * (3 * gamma) * (theta * (theta + 3 * gamma * beta))^-0.5) *    
    (x - sqrt(theta * (theta + 3 * gamma * beta))))/(2 * gamma *    
    beta * x) - (-(x - sqrt(theta * (theta + 3 * gamma * beta)))^2) *    
    (2 * gamma * x)/(2 * gamma * beta * x)^2) + exp((-(x - sqrt(theta *    
    (theta + 3 * gamma * beta)))^2)/(2 * gamma * beta * x)) *    
    (2 * (0.5 * ((3 * gamma) * (theta * (theta + 3 * gamma *    
        beta))^-0.5 + theta * (3 * gamma) * (-0.5 * (((theta +    
        3 * gamma * beta) + theta) * (theta * (theta + 3 * gamma *    
        beta))^-1.5))) * (x - sqrt(theta * (theta + 3 * gamma *    
        beta))) - 0.5 * (theta * (3 * gamma) * (theta * (theta +    
        3 * gamma * beta))^-0.5) * (0.5 * (((theta + 3 * gamma *    
        beta) + theta) * (theta * (theta + 3 * gamma * beta))^-0.5)))/(2 *    
        gamma * beta * x) - 2 * (0.5 * (((theta + 3 * gamma *    
        beta) + theta) * (theta * (theta + 3 * gamma * beta))^-0.5) *    
        (x - sqrt(theta * (theta + 3 * gamma * beta)))) * (2 *    
        gamma * x)/(2 * gamma * beta * x)^2))))/(p * sqrt((theta *    
    (theta + 3 * gamma))/(2 * pi * gamma * (x^3))) * exp((-(x -    
    sqrt(theta * (theta + 3 * gamma)))^2)/(2 * gamma * x)) +    
    +(1 - p) * sqrt((theta * (theta + 3 * gamma * beta))/(2 *    
        pi * gamma * beta * (x^3))) * exp((-(x - sqrt(theta *    
        (theta + 3 * gamma * beta)))^2)/(2 * gamma * beta * x))) -    
    (+(1 - p) * (0.5 * ((theta * (3 * gamma)/(2 * pi * gamma *    
        beta * (x^3)) - (theta * (theta + 3 * gamma * beta)) *    
        (2 * pi * gamma * (x^3))/(2 * pi * gamma * beta * (x^3))^2) *    
        ((theta * (theta + 3 * gamma * beta))/(2 * pi * gamma *    
            beta * (x^3)))^-0.5)) * exp((-(x - sqrt(theta * (theta +    
        3 * gamma * beta)))^2)/(2 * gamma * beta * x)) + +(1 -    
        p) * sqrt((theta * (theta + 3 * gamma * beta))/(2 * pi *    
        gamma * beta * (x^3))) * (exp((-(x - sqrt(theta * (theta +    
        3 * gamma * beta)))^2)/(2 * gamma * beta * x)) * (2 *    
        (0.5 * (theta * (3 * gamma) * (theta * (theta + 3 * gamma *    
            beta))^-0.5) * (x - sqrt(theta * (theta + 3 * gamma *    
            beta))))/(2 * gamma * beta * x) - (-(x - sqrt(theta *    
        (theta + 3 * gamma * beta)))^2) * (2 * gamma * x)/(2 *    
        gamma * beta * x)^2))) * (p * (0.5 * (((theta + 3 * gamma) +    
        theta)/(2 * pi * gamma * (x^3)) * ((theta * (theta +    
        3 * gamma))/(2 * pi * gamma * (x^3)))^-0.5)) * exp((-(x -    
        sqrt(theta * (theta + 3 * gamma)))^2)/(2 * gamma * x)) +    
        p * sqrt((theta * (theta + 3 * gamma))/(2 * pi * gamma *    
            (x^3))) * (exp((-(x - sqrt(theta * (theta + 3 * gamma)))^2)/(2 *    
            gamma * x)) * (2 * (0.5 * (((theta + 3 * gamma) +    
            theta) * (theta * (theta + 3 * gamma))^-0.5) * (x -    
            sqrt(theta * (theta + 3 * gamma))))/(2 * gamma *    
            x))) + (+(1 - p) * (0.5 * (((theta + 3 * gamma *    
        beta) + theta)/(2 * pi * gamma * beta * (x^3)) * ((theta *    
        (theta + 3 * gamma * beta))/(2 * pi * gamma * beta *    
        (x^3)))^-0.5)) * exp((-(x - sqrt(theta * (theta + 3 *    
        gamma * beta)))^2)/(2 * gamma * beta * x)) + +(1 - p) *    
        sqrt((theta * (theta + 3 * gamma * beta))/(2 * pi * gamma *    
            beta * (x^3))) * (exp((-(x - sqrt(theta * (theta +    
        3 * gamma * beta)))^2)/(2 * gamma * beta * x)) * (2 *    
        (0.5 * (((theta + 3 * gamma * beta) + theta) * (theta *    
            (theta + 3 * gamma * beta))^-0.5) * (x - sqrt(theta *    
            (theta + 3 * gamma * beta))))/(2 * gamma * beta *    
        x)))))/(p * sqrt((theta * (theta + 3 * gamma))/(2 * pi *    
        gamma * (x^3))) * exp((-(x - sqrt(theta * (theta + 3 *    
        gamma)))^2)/(2 * gamma * x)) + +(1 - p) * sqrt((theta *    
        (theta + 3 * gamma * beta))/(2 * pi * gamma * beta *    
        (x^3))) * exp((-(x - sqrt(theta * (theta + 3 * gamma *    
        beta)))^2)/(2 * gamma * beta * x)))^2   
       
       
  dbetagamma <- (+(1 - p) * (0.5 * ((theta * 3/(2 * pi * gamma * beta * (x^3)) -    
    theta * (3 * gamma) * (2 * pi * beta * (x^3))/(2 * pi * gamma *    
        beta * (x^3))^2 - ((theta * (3 * beta) * (2 * pi * gamma *    
    (x^3)) + (theta * (theta + 3 * gamma * beta)) * (2 * pi *    
    (x^3)))/(2 * pi * gamma * beta * (x^3))^2 - (theta * (theta +    
    3 * gamma * beta)) * (2 * pi * gamma * (x^3)) * (2 * (2 *    
    pi * beta * (x^3) * (2 * pi * gamma * beta * (x^3))))/((2 *    
    pi * gamma * beta * (x^3))^2)^2)) * ((theta * (theta + 3 *    
    gamma * beta))/(2 * pi * gamma * beta * (x^3)))^-0.5 + (theta *    
    (3 * gamma)/(2 * pi * gamma * beta * (x^3)) - (theta * (theta +    
    3 * gamma * beta)) * (2 * pi * gamma * (x^3))/(2 * pi * gamma *    
    beta * (x^3))^2) * (-0.5 * ((theta * (3 * beta)/(2 * pi *    
    gamma * beta * (x^3)) - (theta * (theta + 3 * gamma * beta)) *    
    (2 * pi * beta * (x^3))/(2 * pi * gamma * beta * (x^3))^2) *    
    ((theta * (theta + 3 * gamma * beta))/(2 * pi * gamma * beta *    
        (x^3)))^-1.5)))) * exp((-(x - sqrt(theta * (theta + 3 *    
    gamma * beta)))^2)/(2 * gamma * beta * x)) + +(1 - p) * (0.5 *    
    ((theta * (3 * gamma)/(2 * pi * gamma * beta * (x^3)) - (theta *    
        (theta + 3 * gamma * beta)) * (2 * pi * gamma * (x^3))/(2 *    
        pi * gamma * beta * (x^3))^2) * ((theta * (theta + 3 *    
        gamma * beta))/(2 * pi * gamma * beta * (x^3)))^-0.5)) *    
    (exp((-(x - sqrt(theta * (theta + 3 * gamma * beta)))^2)/(2 *    
        gamma * beta * x)) * (2 * (0.5 * (theta * (3 * beta) *    
        (theta * (theta + 3 * gamma * beta))^-0.5) * (x - sqrt(theta *    
        (theta + 3 * gamma * beta))))/(2 * gamma * beta * x) -    
        (-(x - sqrt(theta * (theta + 3 * gamma * beta)))^2) *    
            (2 * beta * x)/(2 * gamma * beta * x)^2)) + (+(1 -    
    p) * (0.5 * ((theta * (3 * beta)/(2 * pi * gamma * beta *    
    (x^3)) - (theta * (theta + 3 * gamma * beta)) * (2 * pi *    
    beta * (x^3))/(2 * pi * gamma * beta * (x^3))^2) * ((theta *    
    (theta + 3 * gamma * beta))/(2 * pi * gamma * beta * (x^3)))^-0.5)) *    
    (exp((-(x - sqrt(theta * (theta + 3 * gamma * beta)))^2)/(2 *    
        gamma * beta * x)) * (2 * (0.5 * (theta * (3 * gamma) *    
        (theta * (theta + 3 * gamma * beta))^-0.5) * (x - sqrt(theta *    
        (theta + 3 * gamma * beta))))/(2 * gamma * beta * x) -    
        (-(x - sqrt(theta * (theta + 3 * gamma * beta)))^2) *    
            (2 * gamma * x)/(2 * gamma * beta * x)^2)) + +(1 -    
    p) * sqrt((theta * (theta + 3 * gamma * beta))/(2 * pi *    
    gamma * beta * (x^3))) * (exp((-(x - sqrt(theta * (theta +    
    3 * gamma * beta)))^2)/(2 * gamma * beta * x)) * (2 * (0.5 *    
    (theta * (3 * beta) * (theta * (theta + 3 * gamma * beta))^-0.5) *    
    (x - sqrt(theta * (theta + 3 * gamma * beta))))/(2 * gamma *    
    beta * x) - (-(x - sqrt(theta * (theta + 3 * gamma * beta)))^2) *    
    (2 * beta * x)/(2 * gamma * beta * x)^2) * (2 * (0.5 * (theta *    
    (3 * gamma) * (theta * (theta + 3 * gamma * beta))^-0.5) *    
    (x - sqrt(theta * (theta + 3 * gamma * beta))))/(2 * gamma *    
    beta * x) - (-(x - sqrt(theta * (theta + 3 * gamma * beta)))^2) *    
    (2 * gamma * x)/(2 * gamma * beta * x)^2) + exp((-(x - sqrt(theta *    
    (theta + 3 * gamma * beta)))^2)/(2 * gamma * beta * x)) *    
    (2 * (0.5 * (theta * 3 * (theta * (theta + 3 * gamma * beta))^-0.5 +    
        theta * (3 * gamma) * (-0.5 * (theta * (3 * beta) * (theta *    
            (theta + 3 * gamma * beta))^-1.5))) * (x - sqrt(theta *    
        (theta + 3 * gamma * beta))) - 0.5 * (theta * (3 * gamma) *    
        (theta * (theta + 3 * gamma * beta))^-0.5) * (0.5 * (theta *    
        (3 * beta) * (theta * (theta + 3 * gamma * beta))^-0.5)))/(2 *    
        gamma * beta * x) - 2 * (0.5 * (theta * (3 * gamma) *    
        (theta * (theta + 3 * gamma * beta))^-0.5) * (x - sqrt(theta *    
        (theta + 3 * gamma * beta)))) * (2 * beta * x)/(2 * gamma *    
        beta * x)^2 - ((2 * (0.5 * (theta * (3 * beta) * (theta *    
        (theta + 3 * gamma * beta))^-0.5) * (x - sqrt(theta *    
        (theta + 3 * gamma * beta)))) * (2 * gamma * x) + (-(x -    
        sqrt(theta * (theta + 3 * gamma * beta)))^2) * (2 * x))/(2 *    
        gamma * beta * x)^2 - (-(x - sqrt(theta * (theta + 3 *    
        gamma * beta)))^2) * (2 * gamma * x) * (2 * (2 * beta *    
        x * (2 * gamma * beta * x)))/((2 * gamma * beta * x)^2)^2)))))/(p *    
    sqrt((theta * (theta + 3 * gamma))/(2 * pi * gamma * (x^3))) *    
    exp((-(x - sqrt(theta * (theta + 3 * gamma)))^2)/(2 * gamma *    
        x)) + +(1 - p) * sqrt((theta * (theta + 3 * gamma * beta))/(2 *    
    pi * gamma * beta * (x^3))) * exp((-(x - sqrt(theta * (theta +    
    3 * gamma * beta)))^2)/(2 * gamma * beta * x))) - (+(1 -    
    p) * (0.5 * ((theta * (3 * gamma)/(2 * pi * gamma * beta *    
    (x^3)) - (theta * (theta + 3 * gamma * beta)) * (2 * pi *    
    gamma * (x^3))/(2 * pi * gamma * beta * (x^3))^2) * ((theta *    
    (theta + 3 * gamma * beta))/(2 * pi * gamma * beta * (x^3)))^-0.5)) *    
    exp((-(x - sqrt(theta * (theta + 3 * gamma * beta)))^2)/(2 *    
        gamma * beta * x)) + +(1 - p) * sqrt((theta * (theta +    
    3 * gamma * beta))/(2 * pi * gamma * beta * (x^3))) * (exp((-(x -    
    sqrt(theta * (theta + 3 * gamma * beta)))^2)/(2 * gamma *    
    beta * x)) * (2 * (0.5 * (theta * (3 * gamma) * (theta *    
    (theta + 3 * gamma * beta))^-0.5) * (x - sqrt(theta * (theta +    
    3 * gamma * beta))))/(2 * gamma * beta * x) - (-(x - sqrt(theta *    
    (theta + 3 * gamma * beta)))^2) * (2 * gamma * x)/(2 * gamma *    
    beta * x)^2))) * (p * (0.5 * ((theta * 3/(2 * pi * gamma *    
    (x^3)) - (theta * (theta + 3 * gamma)) * (2 * pi * (x^3))/(2 *    
    pi * gamma * (x^3))^2) * ((theta * (theta + 3 * gamma))/(2 *    
    pi * gamma * (x^3)))^-0.5)) * exp((-(x - sqrt(theta * (theta +    
    3 * gamma)))^2)/(2 * gamma * x)) + p * sqrt((theta * (theta +    
    3 * gamma))/(2 * pi * gamma * (x^3))) * (exp((-(x - sqrt(theta *    
    (theta + 3 * gamma)))^2)/(2 * gamma * x)) * (2 * (0.5 * (theta *    
    3 * (theta * (theta + 3 * gamma))^-0.5) * (x - sqrt(theta *    
    (theta + 3 * gamma))))/(2 * gamma * x) - (-(x - sqrt(theta *    
    (theta + 3 * gamma)))^2) * (2 * x)/(2 * gamma * x)^2)) +    
    (+(1 - p) * (0.5 * ((theta * (3 * beta)/(2 * pi * gamma *    
        beta * (x^3)) - (theta * (theta + 3 * gamma * beta)) *    
        (2 * pi * beta * (x^3))/(2 * pi * gamma * beta * (x^3))^2) *    
        ((theta * (theta + 3 * gamma * beta))/(2 * pi * gamma *    
            beta * (x^3)))^-0.5)) * exp((-(x - sqrt(theta * (theta +    
        3 * gamma * beta)))^2)/(2 * gamma * beta * x)) + +(1 -    
        p) * sqrt((theta * (theta + 3 * gamma * beta))/(2 * pi *    
        gamma * beta * (x^3))) * (exp((-(x - sqrt(theta * (theta +    
        3 * gamma * beta)))^2)/(2 * gamma * beta * x)) * (2 *    
        (0.5 * (theta * (3 * beta) * (theta * (theta + 3 * gamma *    
            beta))^-0.5) * (x - sqrt(theta * (theta + 3 * gamma *    
            beta))))/(2 * gamma * beta * x) - (-(x - sqrt(theta *    
        (theta + 3 * gamma * beta)))^2) * (2 * beta * x)/(2 *    
        gamma * beta * x)^2))))/(p * sqrt((theta * (theta + 3 *    
    gamma))/(2 * pi * gamma * (x^3))) * exp((-(x - sqrt(theta *    
    (theta + 3 * gamma)))^2)/(2 * gamma * x)) + +(1 - p) * sqrt((theta *    
    (theta + 3 * gamma * beta))/(2 * pi * gamma * beta * (x^3))) *    
    exp((-(x - sqrt(theta * (theta + 3 * gamma * beta)))^2)/(2 *    
        gamma * beta * x)))^2   
       
     
  dbetap <- -((sqrt((theta * (theta + 3 * gamma * beta))/(2 * pi * gamma *    
    beta * (x^3))) * (exp((-(x - sqrt(theta * (theta + 3 * gamma *    
    beta)))^2)/(2 * gamma * beta * x)) * (2 * (0.5 * (theta *    
    (3 * gamma) * (theta * (theta + 3 * gamma * beta))^-0.5) *    
    (x - sqrt(theta * (theta + 3 * gamma * beta))))/(2 * gamma *    
    beta * x) - (-(x - sqrt(theta * (theta + 3 * gamma * beta)))^2) *    
    (2 * gamma * x)/(2 * gamma * beta * x)^2)) + (0.5 * ((theta *    
    (3 * gamma)/(2 * pi * gamma * beta * (x^3)) - (theta * (theta +    
    3 * gamma * beta)) * (2 * pi * gamma * (x^3))/(2 * pi * gamma *    
    beta * (x^3))^2) * ((theta * (theta + 3 * gamma * beta))/(2 *    
    pi * gamma * beta * (x^3)))^-0.5)) * exp((-(x - sqrt(theta *    
    (theta + 3 * gamma * beta)))^2)/(2 * gamma * beta * x)))/(p *    
    sqrt((theta * (theta + 3 * gamma))/(2 * pi * gamma * (x^3))) *    
    exp((-(x - sqrt(theta * (theta + 3 * gamma)))^2)/(2 * gamma *    
        x)) + +(1 - p) * sqrt((theta * (theta + 3 * gamma * beta))/(2 *    
    pi * gamma * beta * (x^3))) * exp((-(x - sqrt(theta * (theta +    
    3 * gamma * beta)))^2)/(2 * gamma * beta * x))) + (+(1 -    
    p) * (0.5 * ((theta * (3 * gamma)/(2 * pi * gamma * beta *    
    (x^3)) - (theta * (theta + 3 * gamma * beta)) * (2 * pi *    
    gamma * (x^3))/(2 * pi * gamma * beta * (x^3))^2) * ((theta *    
    (theta + 3 * gamma * beta))/(2 * pi * gamma * beta * (x^3)))^-0.5)) *    
    exp((-(x - sqrt(theta * (theta + 3 * gamma * beta)))^2)/(2 *    
        gamma * beta * x)) + +(1 - p) * sqrt((theta * (theta +    
    3 * gamma * beta))/(2 * pi * gamma * beta * (x^3))) * (exp((-(x -    
    sqrt(theta * (theta + 3 * gamma * beta)))^2)/(2 * gamma *    
    beta * x)) * (2 * (0.5 * (theta * (3 * gamma) * (theta *    
    (theta + 3 * gamma * beta))^-0.5) * (x - sqrt(theta * (theta +    
    3 * gamma * beta))))/(2 * gamma * beta * x) - (-(x - sqrt(theta *    
    (theta + 3 * gamma * beta)))^2) * (2 * gamma * x)/(2 * gamma *    
    beta * x)^2))) * (sqrt((theta * (theta + 3 * gamma))/(2 *    
    pi * gamma * (x^3))) * exp((-(x - sqrt(theta * (theta + 3 *    
    gamma)))^2)/(2 * gamma * x)) - sqrt((theta * (theta + 3 *    
    gamma * beta))/(2 * pi * gamma * beta * (x^3))) * exp((-(x -    
    sqrt(theta * (theta + 3 * gamma * beta)))^2)/(2 * gamma *    
    beta * x)))/(p * sqrt((theta * (theta + 3 * gamma))/(2 *    
    pi * gamma * (x^3))) * exp((-(x - sqrt(theta * (theta + 3 *    
    gamma)))^2)/(2 * gamma * x)) + +(1 - p) * sqrt((theta * (theta +    
    3 * gamma * beta))/(2 * pi * gamma * beta * (x^3))) * exp((-(x -    
    sqrt(theta * (theta + 3 * gamma * beta)))^2)/(2 * gamma *    
    beta * x)))^2)   
       
       
  dbetabeta <- (+(1 - p) * (0.5 * ((theta * (3 * gamma)/(2 * pi * gamma * beta *    
    (x^3)) - (theta * (theta + 3 * gamma * beta)) * (2 * pi *    
    gamma * (x^3))/(2 * pi * gamma * beta * (x^3))^2) * (-0.5 *    
    ((theta * (3 * gamma)/(2 * pi * gamma * beta * (x^3)) - (theta *    
        (theta + 3 * gamma * beta)) * (2 * pi * gamma * (x^3))/(2 *    
        pi * gamma * beta * (x^3))^2) * ((theta * (theta + 3 *    
        gamma * beta))/(2 * pi * gamma * beta * (x^3)))^-1.5)) -    
    (theta * (3 * gamma) * (2 * pi * gamma * (x^3))/(2 * pi *    
        gamma * beta * (x^3))^2 + (theta * (3 * gamma) * (2 *    
        pi * gamma * (x^3))/(2 * pi * gamma * beta * (x^3))^2 -    
        (theta * (theta + 3 * gamma * beta)) * (2 * pi * gamma *    
            (x^3)) * (2 * (2 * pi * gamma * (x^3) * (2 * pi *    
            gamma * beta * (x^3))))/((2 * pi * gamma * beta *    
            (x^3))^2)^2)) * ((theta * (theta + 3 * gamma * beta))/(2 *    
        pi * gamma * beta * (x^3)))^-0.5)) * exp((-(x - sqrt(theta *    
    (theta + 3 * gamma * beta)))^2)/(2 * gamma * beta * x)) +    
    +(1 - p) * (0.5 * ((theta * (3 * gamma)/(2 * pi * gamma *    
        beta * (x^3)) - (theta * (theta + 3 * gamma * beta)) *    
        (2 * pi * gamma * (x^3))/(2 * pi * gamma * beta * (x^3))^2) *    
        ((theta * (theta + 3 * gamma * beta))/(2 * pi * gamma *    
            beta * (x^3)))^-0.5)) * (exp((-(x - sqrt(theta *    
        (theta + 3 * gamma * beta)))^2)/(2 * gamma * beta * x)) *    
        (2 * (0.5 * (theta * (3 * gamma) * (theta * (theta +    
            3 * gamma * beta))^-0.5) * (x - sqrt(theta * (theta +    
            3 * gamma * beta))))/(2 * gamma * beta * x) - (-(x -    
            sqrt(theta * (theta + 3 * gamma * beta)))^2) * (2 *    
            gamma * x)/(2 * gamma * beta * x)^2)) + (+(1 - p) *    
    (0.5 * ((theta * (3 * gamma)/(2 * pi * gamma * beta * (x^3)) -    
        (theta * (theta + 3 * gamma * beta)) * (2 * pi * gamma *    
            (x^3))/(2 * pi * gamma * beta * (x^3))^2) * ((theta *    
        (theta + 3 * gamma * beta))/(2 * pi * gamma * beta *    
        (x^3)))^-0.5)) * (exp((-(x - sqrt(theta * (theta + 3 *    
    gamma * beta)))^2)/(2 * gamma * beta * x)) * (2 * (0.5 *    
    (theta * (3 * gamma) * (theta * (theta + 3 * gamma * beta))^-0.5) *    
    (x - sqrt(theta * (theta + 3 * gamma * beta))))/(2 * gamma *    
    beta * x) - (-(x - sqrt(theta * (theta + 3 * gamma * beta)))^2) *    
    (2 * gamma * x)/(2 * gamma * beta * x)^2)) + +(1 - p) * sqrt((theta *    
    (theta + 3 * gamma * beta))/(2 * pi * gamma * beta * (x^3))) *    
    (exp((-(x - sqrt(theta * (theta + 3 * gamma * beta)))^2)/(2 *    
        gamma * beta * x)) * (2 * (0.5 * (theta * (3 * gamma) *    
        (theta * (theta + 3 * gamma * beta))^-0.5) * (x - sqrt(theta *    
        (theta + 3 * gamma * beta))))/(2 * gamma * beta * x) -    
        (-(x - sqrt(theta * (theta + 3 * gamma * beta)))^2) *    
            (2 * gamma * x)/(2 * gamma * beta * x)^2) * (2 *    
        (0.5 * (theta * (3 * gamma) * (theta * (theta + 3 * gamma *    
            beta))^-0.5) * (x - sqrt(theta * (theta + 3 * gamma *    
            beta))))/(2 * gamma * beta * x) - (-(x - sqrt(theta *    
        (theta + 3 * gamma * beta)))^2) * (2 * gamma * x)/(2 *    
        gamma * beta * x)^2) + exp((-(x - sqrt(theta * (theta +    
        3 * gamma * beta)))^2)/(2 * gamma * beta * x)) * (2 *    
        (0.5 * (theta * (3 * gamma) * (-0.5 * (theta * (3 * gamma) *    
            (theta * (theta + 3 * gamma * beta))^-1.5))) * (x -    
            sqrt(theta * (theta + 3 * gamma * beta))) - 0.5 *    
            (theta * (3 * gamma) * (theta * (theta + 3 * gamma *    
                beta))^-0.5) * (0.5 * (theta * (3 * gamma) *    
            (theta * (theta + 3 * gamma * beta))^-0.5)))/(2 *    
        gamma * beta * x) - 2 * (0.5 * (theta * (3 * gamma) *    
        (theta * (theta + 3 * gamma * beta))^-0.5) * (x - sqrt(theta *    
        (theta + 3 * gamma * beta)))) * (2 * gamma * x)/(2 *    
        gamma * beta * x)^2 - (2 * (0.5 * (theta * (3 * gamma) *    
        (theta * (theta + 3 * gamma * beta))^-0.5) * (x - sqrt(theta *    
        (theta + 3 * gamma * beta)))) * (2 * gamma * x)/(2 *    
        gamma * beta * x)^2 - (-(x - sqrt(theta * (theta + 3 *    
        gamma * beta)))^2) * (2 * gamma * x) * (2 * (2 * gamma *    
        x * (2 * gamma * beta * x)))/((2 * gamma * beta * x)^2)^2)))))/(p *    
    sqrt((theta * (theta + 3 * gamma))/(2 * pi * gamma * (x^3))) *    
    exp((-(x - sqrt(theta * (theta + 3 * gamma)))^2)/(2 * gamma *    
        x)) + +(1 - p) * sqrt((theta * (theta + 3 * gamma * beta))/(2 *    
    pi * gamma * beta * (x^3))) * exp((-(x - sqrt(theta * (theta +    
    3 * gamma * beta)))^2)/(2 * gamma * beta * x))) - (+(1 -    
    p) * (0.5 * ((theta * (3 * gamma)/(2 * pi * gamma * beta *    
    (x^3)) - (theta * (theta + 3 * gamma * beta)) * (2 * pi *    
    gamma * (x^3))/(2 * pi * gamma * beta * (x^3))^2) * ((theta *    
    (theta + 3 * gamma * beta))/(2 * pi * gamma * beta * (x^3)))^-0.5)) *    
    exp((-(x - sqrt(theta * (theta + 3 * gamma * beta)))^2)/(2 *    
        gamma * beta * x)) + +(1 - p) * sqrt((theta * (theta +    
    3 * gamma * beta))/(2 * pi * gamma * beta * (x^3))) * (exp((-(x -    
    sqrt(theta * (theta + 3 * gamma * beta)))^2)/(2 * gamma *    
    beta * x)) * (2 * (0.5 * (theta * (3 * gamma) * (theta *    
    (theta + 3 * gamma * beta))^-0.5) * (x - sqrt(theta * (theta +    
    3 * gamma * beta))))/(2 * gamma * beta * x) - (-(x - sqrt(theta *    
    (theta + 3 * gamma * beta)))^2) * (2 * gamma * x)/(2 * gamma *    
    beta * x)^2))) * (+(1 - p) * (0.5 * ((theta * (3 * gamma)/(2 *    
    pi * gamma * beta * (x^3)) - (theta * (theta + 3 * gamma *    
    beta)) * (2 * pi * gamma * (x^3))/(2 * pi * gamma * beta *    
    (x^3))^2) * ((theta * (theta + 3 * gamma * beta))/(2 * pi *    
    gamma * beta * (x^3)))^-0.5)) * exp((-(x - sqrt(theta * (theta +    
    3 * gamma * beta)))^2)/(2 * gamma * beta * x)) + +(1 - p) *    
    sqrt((theta * (theta + 3 * gamma * beta))/(2 * pi * gamma *    
        beta * (x^3))) * (exp((-(x - sqrt(theta * (theta + 3 *    
    gamma * beta)))^2)/(2 * gamma * beta * x)) * (2 * (0.5 *    
    (theta * (3 * gamma) * (theta * (theta + 3 * gamma * beta))^-0.5) *    
    (x - sqrt(theta * (theta + 3 * gamma * beta))))/(2 * gamma *    
    beta * x) - (-(x - sqrt(theta * (theta + 3 * gamma * beta)))^2) *    
    (2 * gamma * x)/(2 * gamma * beta * x)^2)))/(p * sqrt((theta *    
    (theta + 3 * gamma))/(2 * pi * gamma * (x^3))) * exp((-(x -    
    sqrt(theta * (theta + 3 * gamma)))^2)/(2 * gamma * x)) +    
    +(1 - p) * sqrt((theta * (theta + 3 * gamma * beta))/(2 *    
        pi * gamma * beta * (x^3))) * exp((-(x - sqrt(theta *    
        (theta + 3 * gamma * beta)))^2)/(2 * gamma * beta * x)))^2   
     
     
     
     
  row1 <- cbind(dthetatheta, dthetagamma, dthetap, dthetabeta)   
     
  row2 <- cbind(dgammatheta,dgammagamma,dgammap, dgammabeta)   
     
  row3 <- cbind(dptheta,dpgamma,dpp, dpbeta)   
     
  row4 <- cbind(dbetatheta,dbetagamma,dbetap, dbetabeta)   
       
  mat <- rbind(row1, row2, row3, row4)   
  return(mat)   
}   
   
      
#the rig func      
      
rig <- function(x,theta, gamma){      
        
  inside <- -(x-sqrt(theta*(theta+3*gamma)))^2 #a variable containing the top part of the fraction in the exp      
  dens <- sqrt((theta*(theta+3*gamma))/(2*pi*gamma*(x^3)))*exp(inside/(2*gamma*x))      
  return(dens)      
}      
      
   
   
#weigthed loglikelihood function  
incomloglikcontamweighted <- function(x,p,theta,gamma,beta,weights){ #g is the number of pdfs in mixture   
    m <- length(x)   
    loglik <- 0   
    sum <-0   
    for(k in 1:m){   
         
      sum <- p*rig(x[k],theta,gamma) +(1-p)*rig(x[k],theta,gamma*beta)    
         
      loglik <- loglik + weights[k]*log(sum)   
    }   
       
    return(loglik)   
}   
   
 
#the dAIC function 
   
daic <- function(x,weights,estimates){ #estimates is a vector containing the estimated theta,gamma,  p and beta values   
   
n <- length(x)   
   
vhat <- matrix(0,4,4)   
uhat <- matrix(0,4,4)   
sumweight <-sum(weights)   
for(i in 1:n){   
 vhat <- vhat - (weights[i]/sumweight)*partial2(x[i],theta=estimates[1], gamma=estimates[2], p=estimates[3], beta=estimates[4])    
    
 uhat <- uhat - (weights[i]/sumweight)*t(partial1(x[i],theta=estimates[1], gamma=estimates[2], p=estimates[3], beta=estimates[4]))%*%partial1(x[i],theta=estimates[1], gamma=estimates[2], p=estimates[3], beta=estimates[4])   
}   
   
   
l <- incomloglikcontamweighted(x,theta=estimates[1],gamma=estimates[2],p=estimates[3],beta=estimates[4],weights = weights)   
   
invv <- matrix.inverse(vhat)   
   
dAICval <- 2*l -2*matrix.trace(invv%*%uhat)   
   
return(dAICval)   
}   
   
   
   
   
   
   
   
   
   
   
   
#the function that estimates the parameters    
   
comloglik1 <- function(par,x=X,weights=newweight){      
        
    theta1 <- par[2]      
    gamma1 <- par[3]      
    beta1 <- par[4]      
    p <- par[1]      
    loglik <- 0      
          
    if(theta1<=0){      
      loglik <- 1000000000      
      return(loglik)      
    }      
          
    if(gamma1<=0){      
      loglik <- 100000000      
      return(loglik)      
    }      
          
    if(beta1<=1){      
      loglik <- 100000000      
      return(loglik)      
    }      
          
    if(p<0.5){      
      loglik <- 100000000      
      return(loglik)      
    }      
          
    if(p>1){      
      loglik <- 100000000      
      return(loglik)      
    }      
          
    m <- length(x)      
    for(k in 1:m){      
       loglik <- loglik + weights[k]*log(p*(rig(x[k],theta1,gamma1)) +(1-p)*(rig(x[k],theta1,gamma1*beta1)) )      
           
          
      }      
    negative <- -loglik      
    return(negative)      
  }      
      
      
daicval <- matrix(0,10,1)  
  
      
#initializing:      
set.seed(300)      
  loglik <- vector()      
  n <- length(X)      
  #kmeans initialization      
  print("Initializing using kmeans")      
  cluster <- kmeans(X, centers=2, iter.max = 25)      
      
      
  pvec <- vector()      
  pvec[1] <- length(cluster$cluster[which(cluster$cluster==1)])/n      
  pvec[2] <- length(cluster$cluster[which(cluster$cluster==2)])/n      
        
  #need the pval to be greater than or equal to 0.5      
  if(pvec[1]> pvec[2]){       
    p <- pvec[1]      
    j <- 1 #so that we know which p value is the largest and the other parameters will be associated with them      
  }else{      
    p<- pvec[2]      
    j <- 2}      
#the means and var      
  means <- vector()      
  means[1] <- cluster$centers[1,]      
  means[2] <- cluster$centers[2,]      
      
  lambdahat <- vector()      
  lambdahat[1] <- (means[1]^3)/var(X[which(cluster$cluster==1)])      
  lambdahat[2] <- (means[2]^3)/var(X[which(cluster$cluster==2)])      
      
      
#getting the initial gamma and theta values      
  theta1 <- vector()      
  theta1<- means[j]*(sqrt(1+((9*(means[j]^2))/(4*lambdahat[j]^2)))-(3*means[j])/(2*lambdahat[j])) #use the values associated with the largest p value      
        
      
  gamma1 <- vector()      
  gamma1[1] <- (means[1]^2)/lambdahat[1]      
  gamma1[2] <- (means[2]^2)/lambdahat[2]      
        
  gamma1      
        
  if(gamma1[1]>gamma1[2]){      
    beta1 <- gamma1[1]/gamma1[2]      
    gamma11 <- gamma1[2]      
  }else{beta1 <- gamma1[2]/gamma1[1]      
    gamma11 <- gamma1[1]}      
        
  print(p)      
  print(theta1)      
  print(gamma11)      
  print(beta1)      
  func <-  optim(c(p,theta1,gamma11, beta1), comloglik1,method = "BFGS")      
  p_new <- func$par[1]       
  theta_new <- func$par[2]      
  gamma_new <- func$par[3]      
  beta_new <-  func$par[4]     
     
   
  daicval[1,1] <- daic(x=X,weights=newweight,estimates=c(theta_new,gamma_new, p_new, beta_new))   
   
  print("Initial 1")      
  print(func)   
  print(daicval)      
      
#initialization 1:      
  print("Initializing the qk values")      
for(k in 1:9){      
  n <- length(X)      
      
#randomly assign the value 1 or 2 to a specific observation      
  q <- sample(c(1,2),size = n, replace=TRUE)      
  #print(q)      
      
  pvec <- vector()      
  pvec[1] <- length(q[which(q==1)])/n      
  pvec[2] <- length(q[which(q==2)])/n      
        
  #need the pval to be greater than or equal to 0.5      
  if(pvec[1]> pvec[2]){       
    p <- pvec[1]      
    j <- 1 #so that we know which p value is the largest and the other parameters will be associated with them      
  }else{      
    p<- pvec[2]      
    j <- 2}      
#the means and var      
  means <- vector()      
  means[1] <- mean(X[which(q==1)])      
  means[2] <- mean(X[which(q==2)])      
      
  lambdahat <- vector()      
  lambdahat[1] <- (means[1]^3)/var(X[which(q==1)])      
  lambdahat[2] <- (means[2]^3)/var(X[which(q==2)])      
      
      
#getting the initial gamma and theta values      
  theta1 <- vector()      
  theta1<- means[j]*(sqrt(1+((9*(means[j]^2))/(4*lambdahat[j]^2)))-(3*means[j])/(2*lambdahat[j])) #use the values associated with the largest p value      
        
      
  gamma1 <- vector()      
  gamma1[1] <- (means[1]^2)/lambdahat[1]      
  gamma1[2] <- (means[2]^2)/lambdahat[2]      
        
  gamma1      
        
  if(gamma1[1]>gamma1[2]){      
    beta1 <- gamma1[1]/gamma1[2]      
    gamma11 <- gamma1[2]      
  }else{beta1 <- gamma1[2]/gamma1[1]      
    gamma11 <- gamma1[1]}      
        
  g <- k+1      
  func <- optim(c(p,theta1,gamma11, beta1), comloglik1,method = "BFGS")   
  p_new <- func$par[1]       
  theta_new <- func$par[2]      
  gamma_new <- func$par[3]      
  beta_new <-  func$par[4]     
    
   
  daicval[g,1] <- daic(x=X,weights=newweight,estimates=c(theta_new,gamma_new, p_new, beta_new))   
      
  print("Initial :")      
  print(g)      
  print(func)    
  print(daicval)  
  print(which.max(daicval))  
  }